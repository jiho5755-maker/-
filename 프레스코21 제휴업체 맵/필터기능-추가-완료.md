# 필터 기능 추가 완료!

## ✅ 새로 추가된 기능

### 1. 왼쪽 사이드바 추가
- **레이아웃**: 왼쪽 320px 사이드바 + 오른쪽 지도 영역
- **고정 스크롤**: 사이드바가 스크롤 시 상단에 고정 (sticky)
- **반응형**: 1024px 이하에서 세로 레이아웃으로 전환

### 2. 지역별 필터
- **기능**: 주소에서 자동으로 시/도 추출
- **예시**: 서울, 경기도, 부산, 대구, 인천, 광주, 대전, 울산, 세종 등
- **동작**: 버튼 클릭 시 해당 지역 업체만 지도에 표시

### 3. 카테고리별 필터 (공예 종류)
- **데이터 소스**: C열 (카테고리)
- **자동 생성**: 데이터에서 중복 제거 후 자동으로 버튼 생성
- **동작**: 선택한 카테고리의 업체만 표시

### 4. 협회별 필터
- **데이터 소스**: Q열 (협회) - 새로 추가!
- **자동 생성**: 데이터에서 중복 제거 후 자동으로 버튼 생성
- **동작**: 선택한 협회의 업체만 표시

### 5. 실시간 업체 수 표시
- **위치**: 사이드바 상단
- **기능**: 필터링 결과에 따라 실시간 업데이트
- **예시**: "전체 **15**개"

### 6. 다중 필터 조합
- **기능**: 지역 + 카테고리 + 협회 필터를 동시에 적용 가능
- **예시**: "서울" + "의류" + "한국공예협동조합" 선택 시 모든 조건을 만족하는 업체만 표시

---

## 📊 구글 시트 Q열 추가 필요!

### Q열: 협회

협회 필터 기능이 작동하려면 구글 시트에 Q열을 추가해야 합니다.

**Q열 헤더**: `협회`

**예시 데이터**:
- 한국공예협동조합중앙회
- 한국도예가협회
- 한국섬유공예협회
- 한국목공예가협회
- 한국금속공예가협회
- 기타
- (빈칸 가능)

### Google Apps Script 수정 완료

`Google-Apps-Script-제휴업체-자동화.js` 파일에서 Q열 데이터를 읽어오도록 수정 완료했습니다.

```javascript
association: String(row[16] || '').trim(),   // Q열: 협회
```

---

## 🎨 UI/UX 개선 사항

### 버튼 디자인
- **기본 상태**: 흰색 배경, 회색 테두리
- **호버 상태**: 초록색 테두리, 연한 회색 배경
- **활성 상태**: 초록색 배경, 흰색 텍스트

### 반응형 디자인
- **데스크톱 (1024px 이상)**: 사이드바 + 지도 가로 배치
- **태블릿/모바일 (1024px 이하)**: 사이드바 + 지도 세로 배치
- **모바일 (768px 이하)**: 지도 높이 500px로 조정

---

## 🚀 배포 및 테스트 순서

### 1. Google Apps Script 재배포

Q열 데이터를 읽어오도록 수정했으므로 재배포가 필요합니다.

1. Google Apps Script 에디터 열기
2. `Google-Apps-Script-제휴업체-자동화.js` 내용 복사
3. 스크립트 에디터에 붙여넣기
4. 저장
5. 배포 → 새 배포 → 웹 앱 → 액세스 권한: "모든 사용자" → 배포
6. 새 URL 확인 (기존과 동일할 수 있음)

### 2. 구글 시트에 Q열 추가

1. 구글 시트 열기
2. Q열 추가
3. Q1 셀에 "협회" 입력
4. Q2 이하 셀에 각 업체의 협회명 입력
5. 빈칸이어도 괜찮음 (필터에서 제외됨)

### 3. HTML 파일 GitHub 업로드

1. `제휴업체-지도-통합본.html` 파일 GitHub에 업로드
2. 1~2분 대기 (GitHub Pages 배포)

### 4. 테스트

https://jiho5755-maker.github.io/-21--/ 접속하여:

#### A. 사이드바 확인
- [ ] 왼쪽에 사이드바가 표시되는지 확인
- [ ] "전체 X개" 숫자가 올바르게 표시되는지 확인

#### B. 필터 버튼 확인
- [ ] 지역 필터 버튼들이 생성되었는지 확인
- [ ] 카테고리 필터 버튼들이 생성되었는지 확인
- [ ] 협회 필터 버튼들이 생성되었는지 확인 (Q열 데이터가 있는 경우)

#### C. 필터 동작 확인
- [ ] 지역 버튼 클릭 시 해당 지역 마커만 표시되는지 확인
- [ ] 카테고리 버튼 클릭 시 해당 카테고리 마커만 표시되는지 확인
- [ ] 협회 버튼 클릭 시 해당 협회 마커만 표시되는지 확인
- [ ] "전체" 버튼 클릭 시 모든 마커가 표시되는지 확인

#### D. 다중 필터 확인
- [ ] 지역 + 카테고리 조합 필터 작동 확인
- [ ] 지역 + 협회 조합 필터 작동 확인
- [ ] 지역 + 카테고리 + 협회 조합 필터 작동 확인

#### E. 반응형 확인
- [ ] 데스크톱에서 사이드바가 왼쪽에 표시되는지 확인
- [ ] 브라우저 창 크기를 줄였을 때 세로 레이아웃으로 전환되는지 확인
- [ ] 모바일에서 정상 작동하는지 확인

---

## 📝 참고사항

### 데이터 구조 (업데이트)

| 열 | 필드명 | 설명 | 사용처 |
|----|--------|------|--------|
| B | 업체명 | 업체 이름 | InfoWindow, 마커 |
| C | 카테고리 | 공예 종류 | **카테고리 필터** |
| F | 도로명 주소 | 주소 | **지역 필터 (자동 추출)**, InfoWindow |
| G | 상세 주소 | 상세 주소 | InfoWindow |
| H | 대표 전화번호 | 전화번호 | InfoWindow |
| J | 운영 시간 | 운영 시간 | InfoWindow |
| K | 링크 | 홈페이지/SNS | InfoWindow (여러 링크 지원) |
| L | 한 줄 소개 | 설명 | InfoWindow |
| M | 이미지 URL | 대표 이미지 | InfoWindow |
| N | 심사상태 | 승인 여부 | 필터링 (백엔드) |
| O | 위도 | 좌표 | 마커 위치 |
| P | 경도 | 좌표 | 마커 위치 |
| **Q** | **협회** | **협회명** | **협회 필터 (신규!)** |

### 협회 데이터 예시

```
한국공예협동조합중앙회
한국도예가협회
한국섬유공예협회
한국목공예가협회
한국금속공예가협회
한국가구학회
한국전통문화연구회
기타
```

---

## 🎯 다음 개선 계획 (선택사항)

1. **검색 기능**: 업체명으로 검색
2. **업체 목록 표시**: 사이드바 하단에 스크롤 가능한 업체 목록
3. **마커 클러스터링**: 마커가 많을 때 그룹화
4. **현재 위치 기반 정렬**: 가까운 업체 우선 표시

---

## ⚠️ 주의사항

1. **Google Apps Script 재배포 필수**: Q열 데이터를 읽어오도록 수정했으므로 반드시 재배포해야 합니다.
2. **Q열 추가 권장**: 협회 필터가 작동하려면 구글 시트에 Q열을 추가해야 합니다. Q열이 없어도 다른 기능은 정상 작동합니다.
3. **캐시 삭제**: 브라우저 캐시를 삭제하거나 Cmd+Shift+R로 강제 새로고침하세요.

