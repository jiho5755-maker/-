# 🔗 상담원 연결 완벽 연동 가이드

> 기존 상담 시스템 + Phase 2 스마트 챗봇 완벽 연동

---

## 📋 현재 상황

### 기존 시스템
```
파일: 메이크샵최종/⭐통합본-채널톡포함.html

구성:
- 세이지 그린 ? 버튼 (오른쪽 하단)
- FAQ 팝업 (4가지 메뉴)
- "상담원 연결하기" 버튼
- 채널톡 SDK 연동
```

### 추가할 시스템
```
파일: Phase2-스마트챗봇/99-통합본-스마트챗봇.html

구성:
- 스마트 챗봇 (키워드 인식)
- FAQ 검색
- 영업시간 자동 응답
```

---

## 🎯 연동 목표

```
사용자 클릭: "상담원 연결하기"
  ↓
스마트 챗봇 열림 (자동 응답)
  ↓
해결 안 됨 → 채널톡 실시간 상담
  ↓
해결됨 → 챗봇 닫기
```

---

## 🚀 방법 1: 기존 버튼을 챗봇으로 연결 (추천)

### Step 1: 기존 파일 확인

현재 `메이크샵최종/⭐통합본-채널톡포함.html`에서:

```html
<button class="mk-live" id="ml">상담원 연결하기</button>
```

이 버튼의 JavaScript:

```javascript
if(l){
  l.onclick=openC;
}

function openC(){
  if(window.ChannelIO){
    try{
      ChannelIO('showMessenger');
      closeP();
    }catch(e){
      alert('실시간 상담 준비중입니다.\n이메일: pressco5755@naver.com');
    }
  }else{
    alert('실시간 상담 준비중입니다.\n이메일: pressco5755@naver.com');
  }
}
```

### Step 2: 챗봇 스크립트 추가

기존 하단 레이아웃 **맨 아래에** Phase 2 챗봇 추가:

```html
<!-- 기존 하단 레이아웃 코드 -->
...
</script>

<!-- 여기에 Phase 2 챗봇 추가 -->
<div class="mk-smart-bot" id="mkSmartBot">
  <!-- 챗봇 전체 코드 -->
</div>
<script>
  // 챗봇 전체 스크립트
</script>
```

### Step 3: 기존 버튼 수정

`openC()` 함수를 수정:

```javascript
function openC(){
  // 먼저 스마트 챗봇 열기
  var bot=document.getElementById('mkSmartBot');
  if(bot){
    bot.className='mk-smart-bot on';
    // 기존 팝업 닫기
    closeP();
  }
  
  // 챗봇이 없으면 바로 채널톡
  if(!bot){
    if(window.ChannelIO){
      try{
        ChannelIO('showMessenger');
        closeP();
      }catch(e){
        alert('실시간 상담 준비중입니다.\n이메일: pressco5755@naver.com');
      }
    }else{
      alert('실시간 상담 준비중입니다.\n이메일: pressco5755@naver.com');
    }
  }
}
```

---

## 🚀 방법 2: 통합 파일 제공 (가장 쉬움)

### Step 1: 완전 통합 파일 사용

기존 하단 레이아웃 + Phase 2 챗봇을 **하나로 통합**한 파일 사용

```
파일: 완전통합본-상담시스템.html

포함 내용:
✅ 기존 하단 레이아웃 (회사 정보, CS 센터)
✅ 세이지 그린 ? 버튼
✅ 기본 FAQ 팝업 (4가지)
✅ Phase 2 스마트 챗봇 (3개 탭)
✅ 채널톡 SDK
✅ 완벽한 연동
```

### Step 2: 설치

```
1. 완전통합본-상담시스템.html 열기
2. Cmd+A, Cmd+C (전체 복사)
3. 메이크샵 관리자
   → 디자인 설정
   → 하단 공통 레이아웃
4. 기존 내용 전체 삭제
5. Cmd+V (붙여넣기)
6. [저장]
```

---

## 🎯 작동 흐름 상세

### 시나리오 1: FAQ에서 해결됨

```
1. 사용자: ? 버튼 클릭
2. 시스템: 기본 FAQ 팝업 표시
   [1] 배송 안내
   [2] 교환/반품
   [3] 입금확인
   [4] 기타문의
3. 사용자: [1] 배송 안내 클릭
4. 시스템: 배송 정보 표시
5. 사용자: 만족 → 팝업 닫기 ✅
```

### 시나리오 2: FAQ로 부족 → 챗봇

```
1. 사용자: [4] 기타문의 클릭
2. 사용자: "상담원 연결하기" 클릭
3. 시스템: 스마트 챗봇 열림
4. 챗봇: "안녕하세요! 무엇을 도와드릴까요?"
   [배송 문의] [반품/교환] [적립금] [쿠폰]
5. 사용자: "배송 조회 어떻게 해요?" 입력
6. 챗봇: 배송 조회 방법 + 링크 제공
7. 사용자: 만족 → 챗봇 닫기 ✅
```

### 시나리오 3: 챗봇도 부족 → 실시간 상담

```
1. 사용자: 챗봇에서 복잡한 문의
2. 챗봇: "찾지 못했습니다. 상담원과 연결하시겠어요?"
3. 사용자: "상담원 연결" 클릭
4. 시스템: 
   - 영업시간: 채널톡 메신저 열림
   - 영업시간 외: 이메일 수집 폼 표시
5. 상담원: 실시간 답변 ✅
```

---

## 💻 완전 통합 코드 예시

### 버튼 연동 핵심 코드

```javascript
// 기본 FAQ 팝업의 "상담원 연결하기" 버튼
var liveBtn=document.getElementById('ml');
if(liveBtn){
  liveBtn.onclick=function(){
    // 1. 기본 FAQ 팝업 닫기
    closeP();
    
    // 2. 스마트 챗봇 열기
    var bot=document.getElementById('mkSmartBot');
    if(bot){
      bot.className='mk-smart-bot on';
      
      // 3. 채팅 탭으로 자동 전환
      if(typeof switchTab==='function'){
        switchTab('chat');
      }
    }
    
    // 4. 챗봇이 없으면 바로 채널톡
    else if(window.ChannelIO){
      try{
        ChannelIO('showMessenger');
      }catch(e){
        alert('실시간 상담 준비중입니다.\n이메일: pressco5755@naver.com');
      }
    }
  };
}
```

### 챗봇 → 채널톡 연동 코드

```javascript
// 챗봇 내부의 "상담원 연결" 함수
function connectLive(){
  // 1. 영업시간 확인
  if(isBusinessHours()){
    // 영업시간: 채널톡 즉시 연결
    if(window.ChannelIO){
      ChannelIO('showMessenger');
      // 챗봇 닫기
      document.getElementById('mkSmartBot').className='mk-smart-bot';
    }else{
      alert('실시간 상담을 준비 중입니다.\n이메일: pressco5755@naver.com');
    }
  }else{
    // 영업시간 외: 문의 탭으로 전환
    switchTab('inquiry');
  }
}
```

---

## 🔍 테스트 방법

### 테스트 1: 기본 FAQ → 챗봇

```
1. 쇼핑몰 페이지 접속
2. 오른쪽 하단 ? 버튼 클릭
3. "상담원 연결하기" 버튼 클릭
4. 확인:
   ✅ 기본 팝업 닫힘
   ✅ 스마트 챗봇 열림
   ✅ 채팅 탭이 활성화됨
```

### 테스트 2: 챗봇 키워드 인식

```
1. 챗봇에서 "배송" 입력
2. 확인:
   ✅ 배송 안내 자동 답변
   ✅ 주문 조회 링크 표시
   ✅ 추천 질문 버튼 표시
```

### 테스트 3: 챗봇 → 채널톡 (영업시간)

```
1. 평일 09:00-18:00에 테스트
2. 챗봇에서 "상담원 연결" 클릭
3. 확인:
   ✅ 챗봇 닫힘
   ✅ 채널톡 메신저 열림
   ✅ 실시간 상담 가능
```

### 테스트 4: 챗봇 → 이메일 (영업시간 외)

```
1. 평일 18:00 이후 또는 주말에 테스트
2. 챗봇에서 "문의" 탭 클릭
3. 확인:
   ✅ 이메일 수집 폼 표시
   ✅ "영업시간이 아닙니다" 메시지
   ✅ 이름/이메일/내용 입력 가능
```

---

## 🐛 문제 해결

### Q1. "상담원 연결하기" 클릭해도 챗봇이 안 열려요

**원인**: 챗봇 스크립트가 설치 안 됨

**해결**:
```
1. F12 (개발자 도구)
2. Console 탭
3. 입력: document.getElementById('mkSmartBot')
4. 결과:
   - null → 챗봇 설치 안 됨 ❌
   - <div> → 정상 설치 ✅
```

### Q2. 챗봇에서 채널톡 연결이 안 돼요

**원인**: 채널톡 SDK 설치 안 됨 또는 영업시간 외

**해결**:
```
1. F12 > Console
2. 입력: window.ChannelIO
3. 결과:
   - undefined → 채널톡 SDK 설치 필요 ❌
   - function → 정상 설치 ✅

4. 영업시간 확인:
   - 평일 09:00-18:00
   - 점심시간 12:00-13:00 제외
```

### Q3. 버튼 2개가 보여요

**원인**: 기본 팝업이 안 닫힘

**해결**:
```javascript
// openC() 함수에 closeP() 추가 확인
function openC(){
  closeP(); // 이 줄이 있는지 확인!
  // ...
}
```

---

## 📦 최종 통합 파일 제공

지금 바로 사용 가능한 **완전 통합 파일**을 만들어드릴까요?

```
포함 내용:
✅ 기존 하단 레이아웃 전체
✅ 세이지 그린 상담 버튼
✅ 기본 FAQ (4가지)
✅ Phase 2 스마트 챗봇 (3개 탭)
✅ 채널톡 SDK (플러그인 키 포함)
✅ 완벽한 버튼 연동
✅ 한 파일에 모든 기능

설치:
1. 파일 복사
2. 하단 레이아웃에 붙여넣기
3. 저장
4. 끝!
```

---

## 🎯 연동 체크리스트

### 설치 전
- [ ] 기존 하단 레이아웃 백업
- [ ] 채널톡 플러그인 키 준비
- [ ] 버전 확인 (기존 vs 새로운)

### 설치 중
- [ ] 하단 레이아웃 열기
- [ ] 기존 내용 삭제
- [ ] 새 코드 붙여넣기
- [ ] 플러그인 키 입력 (YOUR_PLUGIN_KEY 검색)
- [ ] 저장

### 설치 후
- [ ] Cmd+Shift+R (강력 새로고침)
- [ ] ? 버튼 클릭 → FAQ 팝업 확인
- [ ] "상담원 연결하기" → 챗봇 확인
- [ ] 챗봇 키워드 테스트 ("배송" 입력)
- [ ] "상담원 연결" → 채널톡 확인

---

## 🎉 완성!

**연동 방법**:
1. 기본 FAQ → 챗봇 ✅
2. 챗봇 → 채널톡 ✅
3. 영업시간 자동 감지 ✅
4. 완벽한 사용자 경험 ✅

**원하시면**:
"완전 통합 파일 만들어줘!"
→ 모든 기능이 포함된 한 파일 제공

🌿✨

