<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 HR ì–¼í‹°ë°‹ ë§ˆìŠ¤í„° ëŒ€ì‹œë³´ë“œ V11 Enhanced</title>
    <!-- SheetJS for Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary: #2563eb;
            --secondary: #1e293b;
            --accent: #3b82f6;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* ì‚¬ì´ë“œë°” */
        .sidebar {
            width: 260px;
            background: var(--secondary);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }
        
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar-header h1 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .sidebar-header p {
            font-size: 12px;
            opacity: 0.7;
        }
        
        .nav-menu {
            margin-top: 20px;
        }
        
        .nav-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .nav-item.active {
            background: var(--primary);
            border-left: 4px solid white;
        }
        
        .nav-icon {
            font-size: 18px;
        }
        
        /* ë©”ì¸ ì»¨í…ì¸  */
        .main-content {
            margin-left: 260px;
            flex: 1;
            padding: 30px;
            width: calc(100% - 260px);
        }
        
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }
        
        .page-header {
            margin-bottom: 30px;
        }
        
        .page-header h2 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .page-header p {
            color: var(--text-light);
            font-size: 14px;
        }
        
        /* ì¹´ë“œ */
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 700;
        }
        
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        
        /* í†µê³„ ì¹´ë“œ */
        .stat-card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary);
        }
        
        .stat-card.success { border-left-color: var(--success); }
        .stat-card.warning { border-left-color: var(--warning); }
        .stat-card.danger { border-left-color: var(--danger); }
        
        .stat-label {
            font-size: 13px;
            color: var(--text-light);
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-desc {
            font-size: 12px;
            color: var(--text-light);
        }
        
        /* ì•Œë¦¼ ì¹´ë“œ */
        .alert-card {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .alert-card.info { background: #dbeafe; border-left: 4px solid var(--primary); }
        .alert-card.warning { background: #fef3c7; border-left: 4px solid var(--warning); }
        .alert-card.danger { background: #fee2e2; border-left: 4px solid var(--danger); }
        
        /* ë²„íŠ¼ */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-outline {
            background: white;
            border: 2px solid var(--border);
            color: var(--text);
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        /* í¼ */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        /* í…Œì´ë¸” */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        .table th {
            background: var(--bg);
            font-weight: 600;
            font-size: 13px;
            color: var(--text-light);
        }
        
        .table tbody tr:hover {
            background: var(--bg);
        }
        
        /* ë±ƒì§€ */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-primary { background: #dbeafe; color: var(--primary); }
        .badge-success { background: #d1fae5; color: var(--success); }
        .badge-warning { background: #fef3c7; color: #d97706; }
        .badge-danger { background: #fee2e2; color: var(--danger); }
        
        /* Kanban ë³´ë“œ */
        .kanban-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        .kanban-column {
            background: var(--bg);
            border-radius: 8px;
            padding: 15px;
        }
        
        .kanban-header {
            font-weight: 700;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
        }
        
        .kanban-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            cursor: move;
        }
        
        .kanban-card-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .kanban-card-meta {
            font-size: 12px;
            color: var(--text-light);
        }
        
        /* ê²°ê³¼ í‘œì‹œ ì˜ì—­ */
        .result-box {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .result-box.success {
            background: #d1fae5;
            border-color: var(--success);
        }
        
        .result-box.danger {
            background: #fee2e2;
            border-color: var(--danger);
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 600;
        }
        
        .result-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }
        
        /* ì¸ì‡„ ìŠ¤íƒ€ì¼ */
        @media print {
            /* ëª¨ë“  ìš”ì†Œ ìˆ¨ê¹€ */
            body * {
                visibility: hidden;
            }
            
            /* ìµœì‹  ì¸ì‡„ ì˜ì—­ë§Œ í‘œì‹œ */
            .print-area.active-print, .print-area.active-print * {
                visibility: visible !important;
            }
            
            /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ì´ˆê¸°í™” */
            .sidebar, .page-header, .btn, .no-print, .card-header, .form-group, .form-row, .form-input, .form-select, .form-textarea, .form-label, .badge, nav, .nav-item, .stat-card, .grid-2, .grid-3, .grid-4, .result-box, .alert-card {
                display: none !important;
                visibility: hidden !important;
            }
            
            .app-container {
                display: block;
            }
            
            .main-content {
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
            }
            
            .content-section {
                display: block !important;
            }
            
            .card {
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
                margin: 0 !important;
                page-break-inside: avoid;
            }
            
            /* ì¸ì‡„ ì˜ì—­ ìŠ¤íƒ€ì¼ */
            .print-area {
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 210mm !important;
                min-height: 297mm !important;
                padding: 20mm !important;
                margin: 0 !important;
                background: white !important;
                page-break-after: always;
            }
            
            .print-header {
                text-align: center;
                margin-bottom: 30px;
                border-bottom: 3px solid black;
                padding-bottom: 15px;
            }
            
            .print-header h1 {
                font-size: 28pt;
                margin-bottom: 10px;
                font-weight: 700;
            }
            
            .print-header p {
                font-size: 12pt;
                margin: 5px 0;
            }
            
            .print-content {
                font-size: 12pt;
                line-height: 2;
            }
            
            .print-content p {
                margin: 10px 0;
            }
            
            .print-table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
            }
            
            .print-table th, .print-table td {
                border: 1px solid black;
                padding: 8px;
                text-align: center;
                font-size: 11pt;
            }
            
            .print-table th {
                background: #f0f0f0 !important;
                font-weight: 700;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .print-signature {
                margin-top: 50px;
                text-align: right;
                font-size: 12pt;
            }
            
            .print-signature p {
                margin: 15px 0;
                line-height: 1.8;
            }
            
            @page {
                size: A4;
                margin: 0;
            }
        }
        
        /* ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        /* íƒ­ */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .tab:hover {
            color: var(--primary);
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-close {
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
        }
        
        /* í”„ë¡œê·¸ë ˆìŠ¤ ë°” */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ì‚¬ì´ë“œë°” -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>âš¡ HR ì–¼í‹°ë°‹ ëŒ€ì‹œë³´ë“œ</h1>
                <p>V11 Enhanced | ì œì¡°/ìœ í†µ ì „ìš©</p>
            </div>
            <nav class="nav-menu">
                <div class="nav-item active" onclick="showSection('dashboard')">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>ëŒ€ì‹œë³´ë“œ í™ˆ</span>
                </div>
                <div class="nav-item" onclick="showSection('payroll')">
                    <span class="nav-icon">ğŸ’°</span>
                    <span>ê¸‰ì—¬ & ì„¸ë¬´</span>
                </div>
                <div class="nav-item" onclick="showSection('attendance')">
                    <span class="nav-icon">ğŸ“…</span>
                    <span>ìœ ì—°ê·¼ë¬´ ê·¼íƒœ</span>
                </div>
                <div class="nav-item" onclick="showSection('collaboration')">
                    <span class="nav-icon">ğŸ¤</span>
                    <span>í˜‘ì—… & ì—…ë¬´</span>
                </div>
                <div class="nav-item" onclick="showSection('admin')">
                    <span class="nav-icon">ğŸ“‹</span>
                    <span>ì—…ë¬´ ì—°ì†ì„±</span>
                </div>
                <div class="nav-item" onclick="showSection('legal')">
                    <span class="nav-icon">âš–ï¸</span>
                    <span>ë²•ì  ë°©ì–´</span>
                </div>
                <div class="nav-item" onclick="showSection('welfare')">
                    <span class="nav-icon">ğŸ¥</span>
                    <span>ë³µì§€ & ì»´í”Œë¼ì´ì–¸ìŠ¤</span>
                </div>
                <div class="nav-item" onclick="showSection('employees')">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>ì§ì› ê´€ë¦¬</span>
                </div>
                <div class="nav-item" onclick="showSection('system')">
                    <span class="nav-icon">âš™ï¸</span>
                    <span>ì‹œìŠ¤í…œ ì„¤ì •</span>
                </div>
            </nav>
        </aside>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <main class="main-content">
            <!-- 1. ëŒ€ì‹œë³´ë“œ í™ˆ -->
            <section id="dashboard" class="content-section active">
                <div class="page-header">
                    <h2>ğŸ“Š ëŒ€ì‹œë³´ë“œ í™ˆ</h2>
                    <p>ì˜¤ëŠ˜ì˜ ì¸ì‚¬ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
                </div>

                <!-- ì˜¤ëŠ˜ì˜ ì•Œë¦¼ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ”” Today's Alert</h3>
                        <span id="todayDate"></span>
                    </div>
                    <div id="todayAlerts"></div>
                </div>

                <!-- íŒ€ í˜„í™©íŒ -->
                <div class="grid-4">
                    <div class="stat-card success">
                        <div class="stat-label">ê·¼ë¬´ ì¤‘</div>
                        <div class="stat-value" id="workingCount">0</div>
                        <div class="stat-desc">ëª…</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-label">ì¬íƒ ê·¼ë¬´</div>
                        <div class="stat-value" id="remoteCount">0</div>
                        <div class="stat-desc">ëª…</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">íœ´ê°€/ì™¸ê·¼</div>
                        <div class="stat-value" id="leaveCount">0</div>
                        <div class="stat-desc">ëª…</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-label">ì „ì²´ ì¸ì›</div>
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-desc">ëª…</div>
                    </div>
                </div>

                <!-- ë°”ë¡œê°€ê¸° -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">âš¡ ë°”ë¡œê°€ê¸°</h3>
                    </div>
                    <div class="grid-3">
                        <button class="btn btn-primary" onclick="showSection('admin'); generateCertificate()">
                            ğŸ“„ ì¦ëª…ì„œ ë°œê¸‰
                        </button>
                        <button class="btn btn-primary" onclick="showSection('attendance')">
                            ğŸ“… ê·¼íƒœì§€ ì¶œë ¥
                        </button>
                        <button class="btn btn-primary" onclick="showSection('payroll')">
                            ğŸ’° ê¸‰ì—¬ ê³„ì‚°
                        </button>
                    </div>
                </div>
            </section>

            <!-- 2. ê¸‰ì—¬ & ì„¸ë¬´ -->
            <section id="payroll" class="content-section">
                <div class="page-header">
                    <h2>ğŸ’° ê¸‰ì—¬ & ì„¸ë¬´ ìµœì í™”</h2>
                    <p>2026ë…„ ìµœì €ì„ê¸ˆ ê¸°ì¤€ í¬ê´„ì„ê¸ˆì œ ì„¤ê³„</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">âš™ï¸ 2026 í¬ê´„ì„ê¸ˆ ì„¤ê³„ê¸°</h3>
                        <span class="badge badge-warning">ìµœì €ì‹œê¸‰ 10,320ì›</span>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì›” ì§€ê¸‰ ì´ì•¡ (ì›)</label>
                            <input type="number" id="totalSalary" class="form-input" placeholder="ì˜ˆ: 3500000" value="3500000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">í¬ë§ ê³ ì • OT ì‹œê°„ (ì‹œê°„/ì›”)</label>
                            <input type="number" id="fixedOT" class="form-input" placeholder="ì˜ˆ: 20" value="20">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ë¹„ê³¼ì„¸ - ì‹ëŒ€ (ì›)</label>
                            <input type="number" id="mealAllowance" class="form-input" placeholder="ìµœëŒ€ 200,000" value="200000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ë¹„ê³¼ì„¸ - ìê°€ìš´ì „ë³´ì¡°ê¸ˆ (ì›)</label>
                            <input type="number" id="carAllowance" class="form-input" placeholder="ìµœëŒ€ 200,000" value="0">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ë¹„ê³¼ì„¸ - ìœ¡ì•„ìˆ˜ë‹¹ (ì›)</label>
                            <input type="number" id="childcareAllowance" class="form-input" placeholder="ìµœëŒ€ 200,000" value="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì£¼ë‹¹ ì†Œì •ê·¼ë¡œì‹œê°„</label>
                            <input type="number" id="weeklyHours" class="form-input" value="40">
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="calculatePayroll()">ğŸ’¡ ìë™ ì„¤ê³„ ì‹¤í–‰</button>

                    <div id="payrollResult" style="margin-top: 20px;"></div>
                </div>

                <!-- ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„± -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ’¸ ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±</h3>
                    </div>

                    <div class="no-print">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ëŒ€ìƒ ì§ì›</label>
                                <select id="payslipEmp" class="form-select" onchange="loadEmployeeSalary()"></select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì§€ê¸‰ ì—°ì›”</label>
                                <input type="month" id="payslipMonth" class="form-input">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ëª…ì„¸ì„œ ë°œê¸‰ì¼</label>
                            <input type="date" id="payslipDate" class="form-input">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ê¸°ë³¸ê¸‰</label>
                                <input type="number" id="payBasic" class="form-input" placeholder="ê¸°ë³¸ê¸‰">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì—°ì¥ìˆ˜ë‹¹</label>
                                <input type="number" id="payOvertime" class="form-input" placeholder="ì—°ì¥ìˆ˜ë‹¹" value="0">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì‹ëŒ€ (ë¹„ê³¼ì„¸)</label>
                                <input type="number" id="payMeal" class="form-input" value="200000">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ê¸°íƒ€ìˆ˜ë‹¹</label>
                                <input type="number" id="payEtc" class="form-input" value="0">
                            </div>
                        </div>

                        <button class="btn btn-primary" onclick="generatePayslip()">ğŸ“„ ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±</button>
                        <button class="btn btn-success" onclick="downloadAsWord()">ğŸ’¾ ì›Œë“œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
                        <button class="btn btn-outline" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°</button>
                    </div>

                    <div id="payslipView" style="margin-top: 20px;"></div>
                </div>
            </section>

            <!-- 3. ìœ ì—°ê·¼ë¬´ ê·¼íƒœ -->
            <section id="attendance" class="content-section">
                <div class="page-header">
                    <h2>ğŸ“… ìœ ì—°ê·¼ë¬´ ê·¼íƒœ & ì§€ì›ê¸ˆ</h2>
                    <p>ì‹¤ì œ ê·¼íƒœ ê´€ë¦¬ + ì •ë¶€ ì§€ì›ê¸ˆìš© ê·¼íƒœ í™•ì¸ì„œ ìë™ ìƒì„±</p>
                </div>

                <!-- ì‹¤ì œ ê·¼íƒœ ê´€ë¦¬ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">â° ì‹¤ì œ ê·¼íƒœ ê´€ë¦¬</h3>
                    </div>

                    <div class="tabs">
                        <div class="tab active" onclick="switchAttTab('checkInOut')">ì¶œí‡´ê·¼ ê¸°ë¡</div>
                        <div class="tab" onclick="switchAttTab('leaveManage')">ì—°ì°¨ ê´€ë¦¬</div>
                        <div class="tab" onclick="switchAttTab('attHistory')">ê·¼íƒœ ì´ë ¥</div>
                    </div>

                    <!-- ì¶œí‡´ê·¼ ê¸°ë¡ íƒ­ -->
                    <div id="checkInOut" class="tab-content active">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì§ì› ì„ íƒ</label>
                                <select id="attCheckEmp" class="form-select"></select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ë‚ ì§œ</label>
                                <input type="date" id="attCheckDate" class="form-input">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì¶œê·¼ ì‹œê°„</label>
                                <input type="time" id="checkInTime" class="form-input" value="09:00">
                            </div>
                            <div class="form-group">
                                <label class="form-label">í‡´ê·¼ ì‹œê°„</label>
                                <input type="time" id="checkOutTime" class="form-input" value="18:00">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ë¹„ê³ </label>
                            <input type="text" id="attNote" class="form-input" placeholder="ì˜ˆ: ì¬íƒê·¼ë¬´, ì™¸ê·¼ ë“±">
                        </div>
                        <button class="btn btn-primary" onclick="recordAttendance()">âœ… ì¶œí‡´ê·¼ ê¸°ë¡ ì €ì¥</button>
                    </div>

                    <!-- ì—°ì°¨ ê´€ë¦¬ íƒ­ -->
                    <div id="leaveManage" class="tab-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì§ì› ì„ íƒ</label>
                                <select id="leaveEmp" class="form-select"></select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì—°ì°¨ êµ¬ë¶„</label>
                                <select id="leaveType" class="form-select">
                                    <option value="ì—°ì°¨">ì—°ì°¨ (1ì¼)</option>
                                    <option value="ë°˜ì°¨">ë°˜ì°¨ (0.5ì¼)</option>
                                    <option value="ë³‘ê°€">ë³‘ê°€</option>
                                    <option value="ê³µê°€">ê³µê°€</option>
                                    <option value="ê²½ì¡°ì‚¬">ê²½ì¡°ì‚¬</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì‹œì‘ì¼</label>
                                <input type="date" id="leaveStart" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì¢…ë£Œì¼</label>
                                <input type="date" id="leaveEnd" class="form-input">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì‚¬ìœ </label>
                            <input type="text" id="leaveReason" class="form-input" placeholder="íœ´ê°€ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <button class="btn btn-primary" onclick="recordLeave()">ğŸ–ï¸ ì—°ì°¨ ì‚¬ìš© ê¸°ë¡</button>

                        <div id="leaveStatus" style="margin-top: 30px;"></div>
                    </div>

                    <!-- ê·¼íƒœ ì´ë ¥ íƒ­ -->
                    <div id="attHistory" class="tab-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì§ì›</label>
                                <select id="historyEmp" class="form-select" onchange="loadAttHistory()"></select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì¡°íšŒ ì›”</label>
                                <input type="month" id="historyMonth" class="form-input" onchange="loadAttHistory()">
                            </div>
                        </div>
                        <button class="btn btn-outline" onclick="loadAttHistory()">ğŸ” ì¡°íšŒ</button>
                        
                        <div id="attHistoryTable" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <!-- ì •ë¶€ ì§€ì›ê¸ˆìš© ê·¼íƒœ í™•ì¸ì„œ -->
                <div class="card">
                    <div class="card-header no-print">
                        <h3 class="card-title">ğŸ“ ê·¼íƒœ í™•ì¸ì„œ ìƒì„±ê¸°</h3>
                    </div>

                    <div class="no-print">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ëŒ€ìƒ ì§ì›</label>
                                <select id="attEmpSelect" class="form-select"></select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ëŒ€ìƒ ì—°ì›”</label>
                                <input type="month" id="attMonth" class="form-input" value="2026-01">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ê·¼ë¬´ í˜•íƒœ</label>
                                <select id="workType" class="form-select">
                                    <option value="ì¬íƒê·¼ë¬´">ì¬íƒê·¼ë¬´</option>
                                    <option value="ì‹œì°¨ì¶œí‡´ê·¼">ì‹œì°¨ì¶œí‡´ê·¼</option>
                                    <option value="ì¼ë°˜ê·¼ë¬´">ì¼ë°˜ê·¼ë¬´</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì„œì‹ ì‘ì„±ì¼</label>
                                <input type="date" id="attDocDate" class="form-input">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì†Œì •ê·¼ë¡œì‹œê°„</label>
                                <input type="text" id="workHours" class="form-input" placeholder="ì˜ˆ: 09:00~18:00" value="09:00~18:00">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ê·¼ë¡œì‹œê°„ ë‹¨ì¶• (ì‹œê°„)</label>
                                <select id="workShortHours" class="form-select">
                                    <option value="0">ë‹¨ì¶• ì—†ìŒ</option>
                                    <option value="1">1ì‹œê°„ ë‹¨ì¶•</option>
                                    <option value="2">2ì‹œê°„ ë‹¨ì¶•</option>
                                    <option value="3">3ì‹œê°„ ë‹¨ì¶•</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ë‹¨ì¶• ì‚¬ìœ </label>
                            <input type="text" id="shortReason" class="form-input" placeholder="ì˜ˆ: ì„ì‹ ê¸° ê·¼ë¡œì‹œê°„ ë‹¨ì¶•, ìœ¡ì•„ê¸° ê·¼ë¡œì‹œê°„ ë‹¨ì¶• ë“±">
                        </div>

                        <button class="btn btn-primary" onclick="generateAttendance()">ğŸ“„ ê·¼íƒœí™•ì¸ì„œ ìƒì„±</button>
                        <button class="btn btn-success" onclick="downloadAsWord()">ğŸ’¾ ì›Œë“œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
                        <button class="btn btn-outline" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°</button>
                    </div>

                    <div id="attendanceSheet" style="margin-top: 20px;"></div>
                </div>
            </section>

            <!-- 4. í˜‘ì—… & ì—…ë¬´ -->
            <section id="collaboration" class="content-section">
                <div class="page-header">
                    <h2>ğŸ¤ í˜‘ì—… & ì—…ë¬´ ê°€ì‹œí™”</h2>
                    <p>ì¬íƒ/ì‹œì°¨ ê·¼ë¬´ìì˜ ì—…ë¬´ íˆ¬ëª…ì„± í™•ë³´</p>
                </div>

                <!-- Kanban ë³´ë“œ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“Œ ì£¼ê°„ ì—…ë¬´ ëª©í‘œ (Kanban)</h3>
                        <button class="btn btn-sm btn-primary" onclick="addKanbanTask()">+ ìƒˆ ì‘ì—…</button>
                    </div>
                    <div class="kanban-board">
                        <div class="kanban-column">
                            <div class="kanban-header">ğŸ“‹ To Do</div>
                            <div id="kanbanTodo"></div>
                        </div>
                        <div class="kanban-column">
                            <div class="kanban-header">ğŸ”„ Doing</div>
                            <div id="kanbanDoing"></div>
                        </div>
                        <div class="kanban-column">
                            <div class="kanban-header">âœ… Done</div>
                            <div id="kanbanDone"></div>
                        </div>
                    </div>
                </div>

                <!-- ë¯¸íŒ… ë¡œê·¸ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“ ë¯¸íŒ… & í˜‘ì—… ë¡œê·¸</h3>
                        <button class="btn btn-sm btn-primary" onclick="addMeetingLog()">+ íšŒì˜ë¡ ì‘ì„±</button>
                    </div>
                    <div id="meetingLogs"></div>
                </div>

                <!-- ê·¸ë¼ìš´ë“œ ë£° -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“œ ìš°ë¦¬ íšŒì‚¬ ê·¸ë¼ìš´ë“œ ë£°</h3>
                    </div>
                    <div style="line-height: 2;">
                        <p>âœ… ì¬íƒê·¼ë¬´ ì‹œ ì½”ì–´íƒ€ì„(10:00~15:00) ì‹¤ì‹œê°„ ì†Œí†µ í•„ìˆ˜</p>
                        <p>âœ… ì‹œì°¨ì¶œí‡´ê·¼ìëŠ” ì „ë‚  ìµì¼ ì¶œê·¼ì‹œê°„ ê³µì§€</p>
                        <p>âœ… ì—…ë¬´ ì‹œì‘/ì¢…ë£Œ ì‹œ ë©”ì‹ ì €ë¡œ íŒ€ì›ì—ê²Œ ìƒíƒœ ê³µìœ </p>
                        <p>âœ… ì¤‘ìš” ê²°ì •ì‚¬í•­ì€ ë¬¸ì„œí™”í•˜ì—¬ ê³µìœ  ë“œë¼ì´ë¸Œì— ì €ì¥</p>
                        <p>âœ… ì£¼ 1íšŒ ì „ì²´ í™”ìƒ íšŒì˜ë¡œ ì§„í–‰ìƒí™© ì ê²€</p>
                    </div>
                </div>
            </section>

            <!-- 5. ì—…ë¬´ ì—°ì†ì„± & í–‰ì • -->
            <section id="admin" class="content-section">
                <div class="page-header">
                    <h2>ğŸ“‹ ì—…ë¬´ ì—°ì†ì„± & í–‰ì •</h2>
                    <p>ì¸ìˆ˜ì¸ê³„, IT ìì‚°, ì¦ëª…ì„œ ë°œê¸‰ ê´€ë¦¬</p>
                </div>

                <!-- ì¸ìˆ˜ì¸ê³„ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ”„ ì¸ìˆ˜ì¸ê³„ ë§ˆìŠ¤í„°</h3>
                    </div>
                    <div class="form-group">
                        <label class="form-label">í‡´ì‚¬ ì˜ˆì •ì</label>
                        <select id="handoverEmp" class="form-select"></select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">í›„ì„ì</label>
                        <select id="successorEmp" class="form-select"></select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì¸ìˆ˜ì¸ê³„ ë‚´ìš©</label>
                        <textarea id="handoverContent" class="form-textarea" placeholder="- ì—…ë¬´ íŒŒì¼ ê²½ë¡œ&#10;- ì¤‘ìš” ì—°ë½ì²˜&#10;- ì§„í–‰ ì¤‘ì¸ í”„ë¡œì íŠ¸&#10;- ì£¼ì˜ì‚¬í•­"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="saveHandover()">ğŸ’¾ ì €ì¥</button>
                </div>

                <!-- IT ìì‚° -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ’» IT ìì‚° ëŒ€ì¥</h3>
                        <button class="btn btn-sm btn-primary" onclick="addITAsset()">+ ìì‚° ì¶”ê°€</button>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>êµ¬ë¶„</th>
                                <th>ëª¨ë¸ëª…/ì œí’ˆëª…</th>
                                <th>ì‹œë¦¬ì–¼ë²ˆí˜¸</th>
                                <th>í• ë‹¹ì</th>
                                <th>ìƒíƒœ</th>
                                <th>ê´€ë¦¬</th>
                            </tr>
                        </thead>
                        <tbody id="itAssetTable"></tbody>
                    </table>
                </div>

                <!-- ì¦ëª…ì„œ ë°œê¸‰ -->
                <div class="card">
                    <div class="card-header no-print">
                        <h3 class="card-title">ğŸ“„ ì¦ëª…ì„œ ë°œê¸‰</h3>
                    </div>
                    <div class="no-print">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ëŒ€ìƒ ì§ì›</label>
                                <select id="certEmpSelect" class="form-select"></select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì¦ëª…ì„œ ì¢…ë¥˜</label>
                                <select id="certType" class="form-select">
                                    <option value="ì¬ì§">ì¬ì§ì¦ëª…ì„œ</option>
                                    <option value="ê²½ë ¥">ê²½ë ¥ì¦ëª…ì„œ</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ë°œê¸‰ì¼</label>
                            <input type="date" id="certDate" class="form-input">
                        </div>
                        <button class="btn btn-primary" onclick="generateCertificate()">ğŸ“„ ì¦ëª…ì„œ ìƒì„±</button>
                        <button class="btn btn-success" onclick="downloadAsWord()">ğŸ’¾ ì›Œë“œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
                        <button class="btn btn-outline" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°</button>
                    </div>
                    <div id="certificateView" style="margin-top: 20px;"></div>
                </div>
            </section>

            <!-- 6. ë²•ì  ë°©ì–´ -->
            <section id="legal" class="content-section">
                <div class="page-header">
                    <h2>âš–ï¸ ë²•ì  ë°©ì–´ & ë¦¬ìŠ¤í¬</h2>
                    <p>ë…¸ë™ìœ„ì›íšŒ ëŒ€ì‘ì„ ìœ„í•œ ì¦ë¹™ ê´€ë¦¬</p>
                </div>

                <!-- ì´ìŠˆ ë¡œê·¸ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“‹ ì´ìŠˆ ê´€ë¦¬ ë¡œê·¸</h3>
                        <button class="btn btn-sm btn-primary" onclick="addIssueLog()">+ ì´ìŠˆ ê¸°ë¡</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ëŒ€ìƒ ì§ì›</label>
                            <select id="issueEmpSelect" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì´ìŠˆ ìœ í˜•</label>
                            <select id="issueType" class="form-select">
                                <option value="ì§€ê°">ì§€ê°/ê²°ê·¼</option>
                                <option value="ì„±ê³¼">ì„±ê³¼ ë¶€ì§„</option>
                                <option value="í¬ìƒ">í¬ìƒ</option>
                                <option value="ê³ ì¶©">ê³ ì¶© ìƒë‹´</option>
                                <option value="ì§•ê³„">ì§•ê³„</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ìƒì„¸ ë‚´ìš©</label>
                        <textarea id="issueContent" class="form-textarea" placeholder="êµ¬ì²´ì ì¸ ìƒí™©ê³¼ ì¦ë¹™ ìë£Œë¥¼ ê¸°ë¡í•˜ì„¸ìš”"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="saveIssueLog()">ğŸ’¾ ì €ì¥</button>

                    <table class="table">
                        <thead>
                            <tr>
                                <th>ë‚ ì§œ</th>
                                <th>ì§ì›</th>
                                <th>ìœ í˜•</th>
                                <th>ë‚´ìš©</th>
                            </tr>
                        </thead>
                        <tbody id="issueLogTable"></tbody>
                    </table>
                </div>

                <!-- ì„œì‹ ìƒì„±ê¸° -->
                <div class="card">
                    <div class="card-header no-print">
                        <h3 class="card-title">ğŸ“ ì„œì‹ ìƒì„±ê¸°</h3>
                    </div>
                    <div class="no-print">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì„œì‹ ì¢…ë¥˜</label>
                                <select id="formType" class="form-select">
                                    <option value="ê²½ê³ ì¥">ê²½ê³ ì¥</option>
                                    <option value="ì‹œë§ì„œ">ì‹œë§ì„œ ì–‘ì‹</option>
                                    <option value="ê¶Œê³ ì‚¬ì§">ê¶Œê³ ì‚¬ì§ì„œ</option>
                                    <option value="í•´ê³ ì˜ˆê³ ">í•´ê³ ì˜ˆê³ í†µë³´ì„œ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ëŒ€ìƒ ì§ì›</label>
                                <select id="formEmpSelect" class="form-select"></select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì„œì‹ ì‘ì„±ì¼</label>
                            <input type="date" id="legalFormDate" class="form-input">
                        </div>
                        <button class="btn btn-danger" onclick="generateLegalForm()">âš ï¸ ì„œì‹ ìƒì„±</button>
                        <button class="btn btn-success" onclick="downloadAsWord()">ğŸ’¾ ì›Œë“œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
                        <button class="btn btn-outline" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°</button>
                    </div>
                    <div id="legalFormView" style="margin-top: 20px;"></div>
                </div>

                <!-- ìœ„í—˜ì„± í‰ê°€ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ›¡ï¸ ìœ„í—˜ì„± í‰ê°€ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
                    </div>
                    <div class="checkbox-group" style="flex-direction: column;">
                        <label class="checkbox-item"><input type="checkbox"> ì‚¬ë¬´ì‹¤ ì „ê¸° ì•ˆì „ ì ê²€ ì™„ë£Œ</label>
                        <label class="checkbox-item"><input type="checkbox"> ì†Œí™”ê¸° ë° ë¹„ìƒêµ¬ ìœ„ì¹˜ í™•ì¸</label>
                        <label class="checkbox-item"><input type="checkbox"> VDT ì¦í›„êµ° ì˜ˆë°© êµìœ¡ ì‹¤ì‹œ</label>
                        <label class="checkbox-item"><input type="checkbox"> ê·¼ê³¨ê²©ê³„ ì§ˆí™˜ ì˜ˆë°© ìŠ¤íŠ¸ë ˆì¹­ ì•ˆë‚´</label>
                        <label class="checkbox-item"><input type="checkbox"> í™”ì¬ ëŒ€í”¼ í›ˆë ¨ ì‹¤ì‹œ (ì—° 1íšŒ)</label>
                    </div>
                </div>
            </section>

            <!-- 7. ë³µì§€ & ì»´í”Œë¼ì´ì–¸ìŠ¤ -->
            <section id="welfare" class="content-section">
                <div class="page-header">
                    <h2>ğŸ¥ ë³µì§€ & ì»´í”Œë¼ì´ì–¸ìŠ¤</h2>
                    <p>ë²•ì • êµìœ¡ ë° ê±´ê°•ê²€ì§„ ê´€ë¦¬</p>
                </div>

                <!-- ë²•ì • êµìœ¡ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“š ë²•ì • ì˜ë¬´ êµìœ¡ ê´€ë¦¬</h3>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>êµìœ¡ëª…</th>
                                <th>ì£¼ê¸°</th>
                                <th>ëŒ€ìƒ</th>
                                <th>ì´ìˆ˜ í˜„í™©</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ì„±í¬ë¡± ì˜ˆë°© êµìœ¡</td>
                                <td>ì—° 1íšŒ (1ì‹œê°„)</td>
                                <td>ì „ ì§ì›</td>
                                <td><span class="badge badge-success">ì™„ë£Œ</span></td>
                            </tr>
                            <tr>
                                <td>ê°œì¸ì •ë³´ë³´í˜¸ êµìœ¡</td>
                                <td>ì—° 1íšŒ (1ì‹œê°„)</td>
                                <td>ì „ ì§ì›</td>
                                <td><span class="badge badge-warning">ë¯¸ì™„ë£Œ</span></td>
                            </tr>
                            <tr>
                                <td>ì‚°ì—…ì•ˆì „ë³´ê±´ êµìœ¡</td>
                                <td>ë¶„ê¸° 6ì‹œê°„</td>
                                <td>ì „ ì§ì›</td>
                                <td><span class="badge badge-success">ì™„ë£Œ</span></td>
                            </tr>
                            <tr>
                                <td>ì¥ì• ì¸ ì¸ì‹ê°œì„  êµìœ¡</td>
                                <td>ì—° 1íšŒ (1ì‹œê°„)</td>
                                <td>ì „ ì§ì›</td>
                                <td><span class="badge badge-warning">ë¯¸ì™„ë£Œ</span></td>
                            </tr>
                            <tr>
                                <td>í‡´ì§ì—°ê¸ˆ êµìœ¡</td>
                                <td>ì—° 1íšŒ</td>
                                <td>ê°€ì…ì</td>
                                <td><span class="badge badge-success">ì™„ë£Œ</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ê±´ê°•ê²€ì§„ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ¥ ê±´ê°•ê²€ì§„ ëŒ€ìƒì ê´€ë¦¬</h3>
                        <button class="btn btn-sm btn-primary" onclick="checkHealthExam()">ğŸ” ëŒ€ìƒì í™•ì¸</button>
                    </div>
                    <div id="healthExamList"></div>
                </div>

                <!-- ê²½ì¡°ì‚¬ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ‰ ê²½ì¡°ì‚¬ íœ´ê°€/ì§€ì›ê¸ˆ ê³„ì‚°ê¸°</h3>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ê²½ì¡°ì‚¬ ì¢…ë¥˜</label>
                        <select id="eventType" class="form-select">
                            <option value="ë³¸ì¸ê²°í˜¼">ë³¸ì¸ ê²°í˜¼</option>
                            <option value="ìë…€ê²°í˜¼">ìë…€ ê²°í˜¼</option>
                            <option value="ë¶€ëª¨ìƒ">ë¶€ëª¨ ì‚¬ë§</option>
                            <option value="ë°°ìš°ìë¶€ëª¨ìƒ">ë°°ìš°ì ë¶€ëª¨ ì‚¬ë§</option>
                            <option value="ì¶œì‚°">ë°°ìš°ì ì¶œì‚°</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="calculateEvent()">ê³„ì‚°í•˜ê¸°</button>
                    <div id="eventResult" style="margin-top: 15px;"></div>
                </div>
            </section>

            <!-- 8. ì‹œìŠ¤í…œ ì„¤ì • -->
            <section id="system" class="content-section">
                <div class="page-header">
                    <h2>âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì •</h2>
                    <p>ë°ì´í„° ë°±ì—… ë° ì‹œìŠ¤í…œ ê´€ë¦¬</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ’¾ ë°ì´í„° ë°±ì—…/ë³µì›</h3>
                    </div>
                    <div class="alert-card info" style="margin-bottom: 20px;">
                        <div>
                            <strong>âš ï¸ ì¤‘ìš” ì•ˆë‚´</strong><br>
                            <small>ì •ê¸°ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë°±ì—…í•˜ì—¬ ì•ˆì „í•˜ê²Œ ë³´ê´€í•˜ì„¸ìš”. ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ ì‹œ ë°ì´í„°ê°€ ì†ì‹¤ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</small>
                        </div>
                    </div>
                    
                    <div class="grid-2" style="margin-bottom: 20px;">
                        <div style="padding: 20px; border: 2px dashed var(--border); border-radius: 8px; text-align: center;">
                            <h4 style="margin-bottom: 15px;">ğŸ“¥ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</h4>
                            <p style="font-size: 13px; color: var(--text-light); margin-bottom: 15px;">
                                í˜„ì¬ ì €ì¥ëœ ëª¨ë“  ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.
                            </p>
                            <button class="btn btn-primary" onclick="exportData()">
                                ğŸ’¾ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                        
                        <div style="padding: 20px; border: 2px dashed var(--border); border-radius: 8px; text-align: center;">
                            <h4 style="margin-bottom: 15px;">ğŸ“¤ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</h4>
                            <p style="font-size: 13px; color: var(--text-light); margin-bottom: 15px;">
                                ë°±ì—… íŒŒì¼ì„ ì„ íƒí•˜ì—¬ ë°ì´í„°ë¥¼ ë³µì›í•©ë‹ˆë‹¤.
                            </p>
                            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
                            <button class="btn btn-success" onclick="document.getElementById('importFile').click()">
                                ğŸ“‚ ë°±ì—… íŒŒì¼ ì„ íƒ
                            </button>
                        </div>
                    </div>
                    
                    <div class="result-box" style="margin-top: 20px;">
                        <h4 style="margin-bottom: 10px;">ğŸ“Š í˜„ì¬ ë°ì´í„° í˜„í™©</h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 15px;">
                            <div>
                                <div style="font-size: 12px; color: var(--text-light);">ë“±ë¡ ì§ì›</div>
                                <div style="font-size: 24px; font-weight: 700; color: var(--primary);" id="dataCountEmp">0</div>
                            </div>
                            <div>
                                <div style="font-size: 12px; color: var(--text-light);">Kanban ì‘ì—…</div>
                                <div style="font-size: 24px; font-weight: 700; color: var(--primary);" id="dataCountKanban">0</div>
                            </div>
                            <div>
                                <div style="font-size: 12px; color: var(--text-light);">ì´ìŠˆ ë¡œê·¸</div>
                                <div style="font-size: 24px; font-weight: 700; color: var(--primary);" id="dataCountIssue">0</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ—‘ï¸ ë°ì´í„° ì´ˆê¸°í™”</h3>
                    </div>
                    <div class="alert-card danger">
                        <div>
                            <strong>âš ï¸ ìœ„í—˜</strong><br>
                            <small>ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ë©° ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ ë°±ì—… í›„ ì‹¤í–‰í•˜ì„¸ìš”.</small>
                        </div>
                    </div>
                    <button class="btn btn-danger" onclick="resetAllData()" style="margin-top: 15px;">
                        ğŸ—‘ï¸ ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”
                    </button>
                </div>
            </section>

            <!-- 9. ì§ì› ê´€ë¦¬ -->
            <section id="employees" class="content-section">
                <div class="page-header">
                    <h2>ğŸ‘¥ ì§ì› ê´€ë¦¬</h2>
                    <p>ì§ì› ì •ë³´ ë“±ë¡ ë° ê´€ë¦¬</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“ ì§ì› ë“±ë¡</h3>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì´ë¦„ *</label>
                            <input type="text" id="empName" class="form-input" placeholder="ì˜ˆ: ê¹€ì² ìˆ˜">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ (ì•ìë¦¬) *</label>
                            <input type="text" id="empSsn" class="form-input" placeholder="ì˜ˆ: 850520" maxlength="6">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ë¶€ì„œ</label>
                            <input type="text" id="empDept" class="form-input" placeholder="ì˜ˆ: ê°œë°œíŒ€">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì§ì±…</label>
                            <input type="text" id="empPosition" class="form-input" placeholder="ì˜ˆ: ì‹¤ì¥">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì…ì‚¬ì¼ *</label>
                            <input type="date" id="empJoinDate" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ìƒë…„ì›”ì¼</label>
                            <input type="date" id="empBirthDate" class="form-input">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ê¸‰ì—¬ (ì›”)</label>
                            <input type="number" id="empSalary" class="form-input" placeholder="ì˜ˆ: 3500000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ê³„ì¢Œë²ˆí˜¸</label>
                            <input type="text" id="empAccount" class="form-input" placeholder="ì˜ˆ: 123-456-789012">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ê·¼ë¬´ í˜•íƒœ</label>
                            <select id="empWorkType" class="form-select">
                                <option value="ì •ê·œì§">ì •ê·œì§</option>
                                <option value="ê³„ì•½ì§">ê³„ì•½ì§</option>
                                <option value="ì¸í„´">ì¸í„´</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì—°ì°¨ ì¼ìˆ˜</label>
                            <input type="number" id="empAnnualLeave" class="form-input" placeholder="15" value="15">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addEmployee()">â• ì§ì› ì¶”ê°€</button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“‹ ì „ì²´ ì§ì› ëª©ë¡ (<span id="totalEmployeeCount">0</span>ëª…)</h3>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ì´ë¦„</th>
                                <th>ì§ì±…</th>
                                <th>ë¶€ì„œ</th>
                                <th>ì…ì‚¬ì¼</th>
                                <th>ì—°ì°¨ ì”ì—¬</th>
                                <th>ìƒíƒœ</th>
                                <th>ê´€ë¦¬</th>
                            </tr>
                        </thead>
                        <tbody id="employeeTable"></tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- ëª¨ë‹¬ -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ìƒˆ ì‘ì—… ì¶”ê°€</h3>
                <span class="modal-close" onclick="closeModal()">&times;</span>
            </div>
            <div class="form-group">
                <label class="form-label">ì‘ì—… ì œëª©</label>
                <input type="text" id="taskTitle" class="form-input">
            </div>
            <div class="form-group">
                <label class="form-label">ë‹´ë‹¹ì</label>
                <select id="taskAssignee" class="form-select"></select>
            </div>
            <div class="form-group">
                <label class="form-label">ìƒíƒœ</label>
                <select id="taskStatus" class="form-select">
                    <option value="todo">To Do</option>
                    <option value="doing">Doing</option>
                    <option value="done">Done</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="saveKanbanTask()">ì €ì¥</button>
        </div>
    </div>

    <script>
        // ì „ì—­ ë°ì´í„°
        let employees = [];
        let kanbanTasks = [];
        let meetingLogs = [];
        let issueLogs = [];
        let itAssets = [];
        let handovers = [];
        let supplies = []; // ì†Œëª¨í’ˆ ìš”ì²­
        let safetyChecks = []; // ì•ˆì „ì ê²€ ê¸°ë¡
        let grants = []; // ì§€ì›ê¸ˆ ë§¤ì¹­ ê²°ê³¼

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            initializeSampleData();
            updateDashboard();
            updateAllSelects();
            updateEmployeeTable();
            generateRecurringTasks(); // V11: ìë™ ë°˜ë³µ ì—…ë¬´ ìƒì„±
            document.getElementById('todayDate').textContent = new Date().toLocaleDateString('ko-KR');
        });

        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë°ì´í„° ë¡œë“œ
        function loadData() {
            employees = JSON.parse(localStorage.getItem('hrEmployees') || '[]');
            kanbanTasks = JSON.parse(localStorage.getItem('hrKanban') || '[]');
            meetingLogs = JSON.parse(localStorage.getItem('hrMeetings') || '[]');
            issueLogs = JSON.parse(localStorage.getItem('hrIssues') || '[]');
            itAssets = JSON.parse(localStorage.getItem('hrAssets') || '[]');
            handovers = JSON.parse(localStorage.getItem('hrHandovers') || '[]');
            supplies = JSON.parse(localStorage.getItem('hrSupplies') || '[]');
            safetyChecks = JSON.parse(localStorage.getItem('hrSafetyChecks') || '[]');
            grants = JSON.parse(localStorage.getItem('hrGrants') || '[]');
        }

        // ë°ì´í„° ì €ì¥
        function saveData() {
            localStorage.setItem('hrEmployees', JSON.stringify(employees));
            localStorage.setItem('hrKanban', JSON.stringify(kanbanTasks));
            localStorage.setItem('hrMeetings', JSON.stringify(meetingLogs));
            localStorage.setItem('hrIssues', JSON.stringify(issueLogs));
            localStorage.setItem('hrAssets', JSON.stringify(itAssets));
            localStorage.setItem('hrHandovers', JSON.stringify(handovers));
            localStorage.setItem('hrSupplies', JSON.stringify(supplies));
            localStorage.setItem('hrSafetyChecks', JSON.stringify(safetyChecks));
            localStorage.setItem('hrGrants', JSON.stringify(grants));
        }

        // ìƒ˜í”Œ ë°ì´í„° ì´ˆê¸°í™”
        function initializeSampleData() {
            if (employees.length === 0) {
                employees = [
                    {
                        id: 1,
                        name: 'ê¹€ì² ìˆ˜',
                        ssn: '850520',
                        position: 'ì‹¤ì¥',
                        dept: 'ê°œë°œíŒ€',
                        joinDate: '2023-03-15',
                        birthDate: '1985-05-20',
                        salary: 4500000,
                        baseSalary: 4500000,
                        account: '110-123-456789',
                        bankAccount: '110-123-456789',
                        bankName: 'ìš°ë¦¬ì€í–‰',
                        workType: 'ì •ê·œì§',
                        empType: 'ì •ê·œì§',
                        hasChild: true,
                        annualLeave: 15,
                        usedLeave: 3,
                        status: 'ê·¼ë¬´ì¤‘',
                        currentWork: 'ì¬íƒ',
                        attendanceRecords: [],
                        leaveRecords: []
                    },
                    {
                        id: 2,
                        name: 'ì´ì˜í¬',
                        ssn: '900815',
                        position: 'ë””ìì´ë„ˆ',
                        dept: 'ë””ìì¸íŒ€',
                        joinDate: '2024-01-10',
                        birthDate: '1990-08-15',
                        salary: 3500000,
                        baseSalary: 3500000,
                        account: '110-234-567890',
                        bankAccount: '110-234-567890',
                        bankName: 'ì‹ í•œì€í–‰',
                        empType: 'ì •ê·œì§',
                        hasChild: false,
                        workType: 'ì •ê·œì§',
                        annualLeave: 15,
                        usedLeave: 1,
                        status: 'ê·¼ë¬´ì¤‘',
                        currentWork: 'ì¶œê·¼',
                        attendanceRecords: [],
                        leaveRecords: []
                    },
                    {
                        id: 3,
                        name: 'ë°•ë¯¼ìˆ˜',
                        ssn: '881203',
                        position: 'ê³¼ì¥',
                        dept: 'ì˜ì—…íŒ€',
                        joinDate: '2022-06-01',
                        birthDate: '1988-12-03',
                        salary: 4000000,
                        account: '110-345-678901',
                        workType: 'ì •ê·œì§',
                        annualLeave: 15,
                        usedLeave: 5,
                        status: 'ê·¼ë¬´ì¤‘',
                        currentWork: 'ì™¸ê·¼',
                        attendanceRecords: [],
                        leaveRecords: []
                    }
                ];
                saveData();
            }

            if (kanbanTasks.length === 0) {
                kanbanTasks = [
                    { id: 1, title: '2026ë…„ ê¸‰ì—¬ í…Œì´ë¸” ê²€í† ', assignee: 'ê¹€ì² ìˆ˜', status: 'todo' },
                    { id: 2, title: 'ê·¼íƒœ ì‹œìŠ¤í…œ ê°œì„ ì•ˆ ì‘ì„±', assignee: 'ì´ì˜í¬', status: 'doing' },
                    { id: 3, title: 'ë²•ì •êµìœ¡ ì¼ì • ìˆ˜ë¦½', assignee: 'ë°•ë¯¼ìˆ˜', status: 'done' }
                ];
                saveData();
            }
        }

        // ì„¹ì…˜ ì „í™˜
        function showSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.nav-item').classList.add('active');

            if (sectionId === 'dashboard') updateDashboard();
            if (sectionId === 'collaboration') updateKanban();
            if (sectionId === 'legal') updateIssueTable();
            if (sectionId === 'admin') updateITAssetTable();
        }

        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        function updateDashboard() {
            const working = employees.filter(e => e.currentWork === 'ì¶œê·¼').length;
            const remote = employees.filter(e => e.currentWork === 'ì¬íƒ').length;
            const leave = employees.filter(e => e.currentWork === 'ì™¸ê·¼' || e.currentWork === 'íœ´ê°€').length;

            document.getElementById('workingCount').textContent = working;
            document.getElementById('remoteCount').textContent = remote;
            document.getElementById('leaveCount').textContent = leave;
            document.getElementById('totalCount').textContent = employees.length;

            // Today's Alert
            const alerts = [];
            const today = new Date();

            employees.forEach(emp => {
                // ìƒì¼ ì²´í¬
                const birth = new Date(emp.birthDate);
                if (birth.getMonth() === today.getMonth() && birth.getDate() === today.getDate()) {
                    alerts.push({
                        type: 'info',
                        message: `ğŸ‚ ${emp.name}ë‹˜ì˜ ìƒì¼ì…ë‹ˆë‹¤!`
                    });
                }

                // ê·¼ì†ì—°ìˆ˜ ì²´í¬
                const join = new Date(emp.joinDate);
                const years = today.getFullYear() - join.getFullYear();
                if (join.getMonth() === today.getMonth() && join.getDate() === today.getDate() && years > 0) {
                    alerts.push({
                        type: 'info',
                        message: `ğŸ‰ ${emp.name}ë‹˜ ì…ì‚¬ ${years}ì£¼ë…„ì„ ì¶•í•˜í•©ë‹ˆë‹¤!`
                    });
                }

                // ê±´ê°•ê²€ì§„ (ì¶œìƒì—°ë„ í™€/ì§)
                const birthYear = birth.getFullYear();
                const currentYear = today.getFullYear();
                if ((birthYear % 2 === currentYear % 2) && today.getMonth() === 0) {
                    alerts.push({
                        type: 'warning',
                        message: `ğŸ¥ ${emp.name}ë‹˜ì€ ì˜¬í•´ ê±´ê°•ê²€ì§„ ëŒ€ìƒìì…ë‹ˆë‹¤.`
                    });
                }
            });

            if (alerts.length === 0) {
                alerts.push({
                    type: 'info',
                    message: 'âœ… ì˜¤ëŠ˜ì€ íŠ¹ë³„í•œ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤.'
                });
            }

            const alertsHtml = alerts.map(alert => `
                <div class="alert-card ${alert.type}">
                    <span>${alert.message}</span>
                </div>
            `).join('');

            document.getElementById('todayAlerts').innerHTML = alertsHtml;
        }

        // ì§ì› ì¶”ê°€
        function addEmployee() {
            const name = document.getElementById('empName').value;
            const ssn = document.getElementById('empSsn').value;
            const dept = document.getElementById('empDept').value;
            const position = document.getElementById('empPosition').value;
            const joinDate = document.getElementById('empJoinDate').value;
            const birthDate = document.getElementById('empBirthDate').value;
            const salary = parseInt(document.getElementById('empSalary').value) || 0;
            const account = document.getElementById('empAccount').value;
            const workType = document.getElementById('empWorkType').value;
            const annualLeave = parseInt(document.getElementById('empAnnualLeave').value) || 15;

            if (!name || !joinDate) {
                alert('í•„ìˆ˜ í•­ëª©(ì´ë¦„, ì…ì‚¬ì¼)ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const newEmployee = {
                id: Date.now(),
                name,
                ssn,
                dept,
                position,
                joinDate,
                birthDate,
                salary,
                account,
                workType,
                annualLeave,
                usedLeave: 0,
                status: 'ê·¼ë¬´ì¤‘',
                currentWork: 'ì¶œê·¼',
                attendanceRecords: [], // ì¶œí‡´ê·¼ ê¸°ë¡
                leaveRecords: [] // ì—°ì°¨ ì‚¬ìš© ê¸°ë¡
            };

            employees.push(newEmployee);
            saveData();
            updateEmployeeTable();
            updateAllSelects();
            updateDataCount();
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('empName').value = '';
            document.getElementById('empSsn').value = '';
            document.getElementById('empDept').value = '';
            document.getElementById('empPosition').value = '';
            document.getElementById('empJoinDate').value = '';
            document.getElementById('empBirthDate').value = '';
            document.getElementById('empSalary').value = '';
            document.getElementById('empAccount').value = '';
            document.getElementById('empAnnualLeave').value = '15';

            alert('ì§ì›ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ì§ì› í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateEmployeeTable() {
            const tbody = document.getElementById('employeeTable');
            tbody.innerHTML = employees.map(emp => {
                const join = new Date(emp.joinDate);
                const today = new Date();
                const years = Math.floor((today - join) / (365.25 * 24 * 60 * 60 * 1000));
                const remainLeave = (emp.annualLeave || 15) - (emp.usedLeave || 0);
                
                return `
                    <tr>
                        <td><strong>${emp.name}</strong>${emp.ssn ? '<br><small style="color: var(--text-light);">' + emp.ssn + '</small>' : ''}</td>
                        <td>${emp.position || '-'}</td>
                        <td>${emp.dept || '-'}</td>
                        <td>${emp.joinDate}<br><small style="color: var(--text-light);">${years}ë…„</small></td>
                        <td><strong style="color: ${remainLeave < 3 ? 'var(--danger)' : 'var(--success)'}">${remainLeave}ì¼</strong></td>
                        <td><span class="badge badge-success">${emp.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editEmployee(${emp.id})">ìˆ˜ì •</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteEmployee(${emp.id})">ì‚­ì œ</button>
                        </td>
                    </tr>
                `;
            }).join('');

            // ì§ì› ìˆ˜ í‘œì‹œ
            const countElem = document.getElementById('totalEmployeeCount');
            if (countElem) {
                countElem.textContent = employees.length;
            }
        }

        // ì§ì› ì •ë³´ ìˆ˜ì •
        function editEmployee(id) {
            const emp = employees.find(e => e.id === id);
            if (!emp) return;

            // ì…ë ¥ í¼ì— ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸°
            document.getElementById('empName').value = emp.name || '';
            document.getElementById('empSsn').value = emp.ssn || '';
            document.getElementById('empDept').value = emp.dept || '';
            document.getElementById('empPosition').value = emp.position || '';
            document.getElementById('empJoinDate').value = emp.joinDate || '';
            document.getElementById('empBirthDate').value = emp.birthDate || '';
            document.getElementById('empSalary').value = emp.salary || '';
            document.getElementById('empAccount').value = emp.account || '';
            document.getElementById('empWorkType').value = emp.workType || 'ì •ê·œì§';
            document.getElementById('empAnnualLeave').value = emp.annualLeave || 15;

            // ì§ì› ì¶”ê°€ ë²„íŠ¼ì„ ìˆ˜ì • ëª¨ë“œë¡œ ë³€ê²½
            const addBtn = document.querySelector('button[onclick="addEmployee()"]');
            addBtn.textContent = 'âœï¸ ì§ì› ì •ë³´ ìˆ˜ì •';
            addBtn.className = 'btn btn-success';
            addBtn.onclick = function() { updateEmployee(id); };

            // ì·¨ì†Œ ë²„íŠ¼ ì¶”ê°€
            const cancelBtn = document.createElement('button');
            cancelBtn.textContent = 'âŒ ì·¨ì†Œ';
            cancelBtn.className = 'btn btn-outline';
            cancelBtn.style.marginLeft = '10px';
            cancelBtn.onclick = cancelEdit;
            addBtn.parentElement.appendChild(cancelBtn);

            // ì§ì› ë“±ë¡ í¼ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            document.querySelector('#employees .card').scrollIntoView({ behavior: 'smooth' });
        }

        // ì§ì› ì •ë³´ ì—…ë°ì´íŠ¸
        function updateEmployee(id) {
            const emp = employees.find(e => e.id === id);
            if (!emp) return;

            emp.name = document.getElementById('empName').value;
            emp.ssn = document.getElementById('empSsn').value;
            emp.dept = document.getElementById('empDept').value;
            emp.position = document.getElementById('empPosition').value;
            emp.joinDate = document.getElementById('empJoinDate').value;
            emp.birthDate = document.getElementById('empBirthDate').value;
            emp.salary = parseInt(document.getElementById('empSalary').value) || 0;
            emp.account = document.getElementById('empAccount').value;
            emp.workType = document.getElementById('empWorkType').value;
            emp.annualLeave = parseInt(document.getElementById('empAnnualLeave').value) || 15;

            if (!emp.name || !emp.joinDate) {
                alert('í•„ìˆ˜ í•­ëª©(ì´ë¦„, ì…ì‚¬ì¼)ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            saveData();
            updateEmployeeTable();
            updateAllSelects();
            updateDataCount();
            cancelEdit();

            alert('âœ… ì§ì› ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ìˆ˜ì • ëª¨ë“œ ì·¨ì†Œ
        function cancelEdit() {
            // í¼ ì´ˆê¸°í™”
            document.getElementById('empName').value = '';
            document.getElementById('empSsn').value = '';
            document.getElementById('empDept').value = '';
            document.getElementById('empPosition').value = '';
            document.getElementById('empJoinDate').value = '';
            document.getElementById('empBirthDate').value = '';
            document.getElementById('empSalary').value = '';
            document.getElementById('empAccount').value = '';
            document.getElementById('empAnnualLeave').value = '15';

            // ë²„íŠ¼ ì›ë˜ëŒ€ë¡œ
            const addBtn = document.querySelector('#employees .card button');
            addBtn.textContent = 'â• ì§ì› ì¶”ê°€';
            addBtn.className = 'btn btn-primary';
            addBtn.onclick = addEmployee;

            // ì·¨ì†Œ ë²„íŠ¼ ì œê±°
            const cancelBtn = addBtn.nextElementSibling;
            if (cancelBtn && cancelBtn.textContent.includes('ì·¨ì†Œ')) {
                cancelBtn.remove();
            }
        }

        // ì§ì› ì‚­ì œ
        function deleteEmployee(id) {
            const emp = employees.find(e => e.id === id);
            if (!emp) return;

            if (confirm(`ì •ë§ "${emp.name}" ì§ì›ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nê´€ë ¨ëœ ëª¨ë“  ë°ì´í„°(ì¶œí‡´ê·¼, ì—°ì°¨ ê¸°ë¡)ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.`)) {
                employees = employees.filter(e => e.id !== id);
                saveData();
                updateEmployeeTable();
                updateAllSelects();
                updateDataCount();
                alert('âœ… ì§ì›ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ëª¨ë“  ì…€ë ‰íŠ¸ ì—…ë°ì´íŠ¸
        function updateAllSelects() {
            const selects = [
                'attEmpSelect', 'certEmpSelect', 'issueEmpSelect', 
                'formEmpSelect', 'handoverEmp', 'successorEmp', 'taskAssignee',
                'attCheckEmp', 'leaveEmp', 'historyEmp', 'payslipEmp'
            ];

            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = employees.map(emp => 
                        `<option value="${emp.id}">${emp.name} ${emp.position ? '(' + emp.position + ')' : ''}</option>`
                    ).join('');
                }
            });
        }

        // í¬ê´„ì„ê¸ˆ ê³„ì‚°
        // ========== V11 ì‹ ê·œ ê¸°ëŠ¥: Grant Sniper (ì •ë¶€ì§€ì›ê¸ˆ ìë™ ë§¤ì¹­) ==========
        function analyzeGrants(emp) {
            const matchedGrants = [];
            const today = new Date();
            const birthDate = new Date(emp.birthDate);
            const age = today.getFullYear() - birthDate.getFullYear();
            const workMonths = Math.floor((today - new Date(emp.joinDate)) / (1000 * 60 * 60 * 24 * 30));
            
            // 1. ì²­ë…„ì¼ìë¦¬ë„ì•½ì¥ë ¤ê¸ˆ (ë§Œ 15~34ì„¸, ì›”ê¸‰ 200ë§Œì› ì´ìƒ)
            if (age >= 15 && age <= 34 && emp.baseSalary >= 2000000) {
                matchedGrants.push({
                    name: "ì²­ë…„ì¼ìë¦¬ë„ì•½ì¥ë ¤ê¸ˆ",
                    amount: "ì›” 60ë§Œì› (ìµœëŒ€ 12ê°œì›”)",
                    deadline: "ì…ì‚¬ í›„ 3ê°œì›” ì´ë‚´",
                    docs: ["ê·¼ë¡œê³„ì•½ì„œ", "ì„ê¸ˆëŒ€ì¥", "ì¶œí‡´ê·¼ê¸°ë¡ë¶€"]
                });
            }
            
            // 2. ê³ ë ¹ì ê³ ìš©ì§€ì›ê¸ˆ (ë§Œ 60ì„¸ ì´ìƒ)
            if (age >= 60) {
                matchedGrants.push({
                    name: "ê³ ë ¹ì ê³ ìš©ì§€ì›ê¸ˆ",
                    amount: "ë¶„ê¸° 30ë§Œì›",
                    deadline: "ë¶„ê¸°ë³„ ì‹ ì²­",
                    docs: ["ê·¼ë¡œê³„ì•½ì„œ", "ì£¼ë¯¼ë“±ë¡ë“±ë³¸"]
                });
            }
            
            // 3. ë‘ë£¨ëˆ„ë¦¬ ì‚¬íšŒë³´í—˜ë£Œ ì§€ì› (ì›” ë³´ìˆ˜ 270ë§Œì› ë¯¸ë§Œ)
            if (emp.baseSalary < 2700000 && emp.empType !== 'í”„ë¦¬ëœì„œ') {
                matchedGrants.push({
                    name: "ë‘ë£¨ëˆ„ë¦¬ ì‚¬íšŒë³´í—˜ë£Œ ì§€ì›",
                    amount: "4ëŒ€ë³´í—˜ë£Œ 80% ì§€ì›",
                    deadline: "ì—°ì¤‘ ì‹ ì²­ ê°€ëŠ¥",
                    docs: ["ì‚¬ì—…ìë“±ë¡ì¦", "ê·¼ë¡œê³„ì•½ì„œ"]
                });
            }
            
            // 4. ìœ¡ì•„íœ´ì§ ëŒ€ì²´ì¸ë ¥ ì§€ì›ê¸ˆ
            if (emp.hasChild && workMonths >= 6) {
                matchedGrants.push({
                    name: "ìœ¡ì•„íœ´ì§ ëŒ€ì²´ì¸ë ¥ ì§€ì›ê¸ˆ",
                    amount: "ì›” 120ë§Œì› (ëŒ€ì²´ì¸ë ¥ ì±„ìš© ì‹œ)",
                    deadline: "íœ´ì§ ì‹œì‘ ì „",
                    docs: ["ìœ¡ì•„íœ´ì§ ì‹ ì²­ì„œ", "ê°€ì¡±ê´€ê³„ì¦ëª…ì„œ"]
                });
            }
            
            // 5. ì¼ìë¦¬ì•ˆì •ìê¸ˆ (ìµœì €ì„ê¸ˆ ê¸°ì¤€)
            const minWageMonthly = 10320 * 209; // 2026 ìµœì €ì„ê¸ˆ ì›”í™˜ì‚°
            if (emp.baseSalary >= minWageMonthly && emp.baseSalary < 2700000) {
                matchedGrants.push({
                    name: "ì¼ìë¦¬ì•ˆì •ìê¸ˆ",
                    amount: "ì›” 4ë§Œì›",
                    deadline: "ë¶„ê¸°ë³„ ì‹ ì²­",
                    docs: ["ì„ê¸ˆëŒ€ì¥"]
                });
            }
            
            return matchedGrants;
        }
        
        // Grant Sniper ê²°ê³¼ í‘œì‹œ
        function showGrantsForEmployee(empId) {
            const emp = employees.find(e => e.id == empId);
            if (!emp) {
                alert('ì§ì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const matchedGrants = analyzeGrants(emp);
            
            if (matchedGrants.length === 0) {
                alert(`${emp.name}ë‹˜ì€ í˜„ì¬ ì‹ ì²­ ê°€ëŠ¥í•œ ì§€ì›ê¸ˆì´ ì—†ìŠµë‹ˆë‹¤.`);
                return;
            }
            
            let msg = `ğŸ’° ${emp.name}ë‹˜ ì§€ì›ê¸ˆ ë§¤ì¹­ ê²°ê³¼\n\n`;
            matchedGrants.forEach((g, i) => {
                msg += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                msg += `${i+1}. ${g.name}\n`;
                msg += `   ğŸ’µ ì§€ì›ê¸ˆì•¡: ${g.amount}\n`;
                msg += `   ğŸ“… ì‹ ì²­ê¸°í•œ: ${g.deadline}\n`;
                msg += `   ğŸ“„ í•„ìš”ì„œë¥˜: ${g.docs.join(', ')}\n\n`;
            });
            msg += `\nğŸ“¦ ì›í´ë¦­ ì„œë¥˜íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
            
            if (confirm(msg)) {
                alert(`${emp.name}ë‹˜ì˜ ì§€ì›ê¸ˆ ì‹ ì²­ ì„œë¥˜ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n(ê·¼ë¡œê³„ì•½ì„œ + ì„ê¸ˆëŒ€ì¥ + ì¶œí‡´ê·¼ê¸°ë¡ë¶€)\n\nì‹¤ì œ êµ¬í˜„ ì‹œ PDFë¡œ í†µí•© ìƒì„±ë©ë‹ˆë‹¤.`);
            }
        }
        
        // Three Strikes Rule ì²´í¬
        function checkThreeStrikes(empId) {
            const empIssues = issueLogs.filter(log => log.employee === employees.find(e => e.id == empId)?.name);
            const issueTypes = {};
            
            empIssues.forEach(issue => {
                issueTypes[issue.type] = (issueTypes[issue.type] || 0) + 1;
            });
            
            const warnings = [];
            for (const [type, count] of Object.entries(issueTypes)) {
                if (count >= 3) {
                    warnings.push({ type, count });
                }
            }
            
            return warnings;
        }

        function calculatePayroll() {
            const totalSalary = parseInt(document.getElementById('totalSalary').value) || 0;
            const fixedOT = parseInt(document.getElementById('fixedOT').value) || 0;
            const mealAllowance = parseInt(document.getElementById('mealAllowance').value) || 0;
            const carAllowance = parseInt(document.getElementById('carAllowance').value) || 0;
            const childcareAllowance = parseInt(document.getElementById('childcareAllowance').value) || 0;
            const weeklyHours = parseInt(document.getElementById('weeklyHours').value) || 40;

            const minWage = 10320; // 2026 ìµœì €ì‹œê¸‰
            const monthlyHours = (weeklyHours * 52) / 12; // ì›” ì†Œì •ê·¼ë¡œì‹œê°„
            const taxFree = mealAllowance + carAllowance + childcareAllowance;
            const taxable = totalSalary - taxFree;

            // ê³ ì •ì—°ì¥ìˆ˜ë‹¹ ê³„ì‚°
            const overtimePay = fixedOT * minWage * 1.5;
            
            // ê¸°ë³¸ê¸‰ = ê³¼ì„¸ê¸‰ì—¬ - ê³ ì •ì—°ì¥ìˆ˜ë‹¹
            const baseSalary = taxable - overtimePay;

            // ì‹œê¸‰ ì—­ì‚°
            const hourlyWage = baseSalary / monthlyHours;

            // ìµœì €ì„ê¸ˆ ìœ„ë°˜ ì²´í¬
            const isViolation = hourlyWage < minWage;

            // 4ëŒ€ë³´í—˜ ì¶”ì • (ê°„ë‹¨ ê³„ì‚°)
            const nationalPension = Math.floor(baseSalary * 0.045);
            const healthInsurance = Math.floor(baseSalary * 0.03545);
            const employmentInsurance = Math.floor(baseSalary * 0.009);
            const totalInsurance = nationalPension + healthInsurance + employmentInsurance;

            const resultHtml = `
                <div class="result-box ${isViolation ? 'danger' : 'success'}">
                    <h4 style="margin-bottom: 15px; ${isViolation ? 'color: var(--danger)' : ''}">
                        ${isViolation ? 'âš ï¸ ìµœì €ì„ê¸ˆ ìœ„ë°˜!' : 'âœ… ì ë²•í•œ ì„¤ê³„'}
                    </h4>
                    <div class="result-item">
                        <span class="result-label">ê¸°ë³¸ê¸‰</span>
                        <span class="result-value">${baseSalary.toLocaleString()}ì›</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ê³ ì • ì—°ì¥ìˆ˜ë‹¹ (${fixedOT}ì‹œê°„)</span>
                        <span class="result-value">${overtimePay.toLocaleString()}ì›</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ë¹„ê³¼ì„¸ ìˆ˜ë‹¹</span>
                        <span class="result-value">${taxFree.toLocaleString()}ì›</span>
                    </div>
                    <div class="result-item" style="border-top: 2px solid var(--border); padding-top: 15px; margin-top: 10px;">
                        <span class="result-label"><strong>ì›” ì§€ê¸‰ ì´ì•¡</strong></span>
                        <span class="result-value">${totalSalary.toLocaleString()}ì›</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ì—­ì‚° ì‹œê¸‰</span>
                        <span class="result-value" style="${isViolation ? 'color: var(--danger)' : ''}">${Math.floor(hourlyWage).toLocaleString()}ì›</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">4ëŒ€ë³´í—˜ íšŒì‚¬ë¶€ë‹´ (ì¶”ì •)</span>
                        <span class="result-value">${totalInsurance.toLocaleString()}ì›/ì›”</span>
                    </div>
                </div>
                <div style="margin-top: 15px;">
                    <button class="btn btn-primary" onclick="copyPayrollClause()">ğŸ“‹ ê·¼ë¡œê³„ì•½ì„œ ì„ê¸ˆì¡°í•­ ë³µì‚¬</button>
                </div>
            `;

            document.getElementById('payrollResult').innerHTML = resultHtml;
        }

        // ê·¼ë¡œê³„ì•½ì„œ ì„ê¸ˆì¡°í•­ ë³µì‚¬
        function copyPayrollClause() {
            const totalSalary = parseInt(document.getElementById('totalSalary').value) || 0;
            const fixedOT = parseInt(document.getElementById('fixedOT').value) || 0;
            const mealAllowance = parseInt(document.getElementById('mealAllowance').value) || 0;
            
            const taxFree = mealAllowance;
            const taxable = totalSalary - taxFree;
            const baseSalary = taxable - (fixedOT * 10320 * 1.5);
            const overtimePay = fixedOT * 10320 * 1.5;

            const clause = `ì œâ—‹ì¡° (ì„ê¸ˆ)
â‘  ê·¼ë¡œìì˜ ì„ê¸ˆì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
   - ê¸°ë³¸ê¸‰: ì›” ${baseSalary.toLocaleString()}ì›
   - ê³ ì • ì—°ì¥ê·¼ë¡œìˆ˜ë‹¹: ì›” ${overtimePay.toLocaleString()}ì› (ì›” ${fixedOT}ì‹œê°„ë¶„)
   - ì‹ëŒ€(ë¹„ê³¼ì„¸): ì›” ${mealAllowance.toLocaleString()}ì›
   - ì›” ì§€ê¸‰ ì´ì•¡: ${totalSalary.toLocaleString()}ì›

â‘¡ ìœ„ ê³ ì • ì—°ì¥ê·¼ë¡œìˆ˜ë‹¹ì€ ì›” ${fixedOT}ì‹œê°„ì˜ ì—°ì¥ê·¼ë¡œì— ëŒ€í•œ ìˆ˜ë‹¹ì„ ë¯¸ë¦¬ ì •í•˜ì—¬ ì§€ê¸‰í•˜ëŠ” ê²ƒìœ¼ë¡œ, ${fixedOT}ì‹œê°„ì„ ì´ˆê³¼í•˜ëŠ” ì—°ì¥ê·¼ë¡œì— ëŒ€í•˜ì—¬ëŠ” ë³„ë„ë¡œ ê°€ì‚°ìˆ˜ë‹¹ì„ ì§€ê¸‰í•œë‹¤.`;

            navigator.clipboard.writeText(clause).then(() => {
                alert('ì„ê¸ˆì¡°í•­ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        // ê·¼íƒœí™•ì¸ì„œ ìƒì„±
        function generateAttendance() {
            const empId = document.getElementById('attEmpSelect').value;
            const month = document.getElementById('attMonth').value;
            const workType = document.getElementById('workType').value;
            const workHours = document.getElementById('workHours').value;
            const shortHours = parseInt(document.getElementById('workShortHours').value) || 0;
            const shortReason = document.getElementById('shortReason').value;
            const docDate = document.getElementById('attDocDate').value;

            const emp = employees.find(e => e.id == empId);
            if (!emp) {
                alert('ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì„œì‹ ì‘ì„±ì¼ (ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ëŠ˜)
            const selectedDate = docDate ? new Date(docDate) : new Date();
            const formattedDate = `${selectedDate.getFullYear()}. ${selectedDate.getMonth() + 1}. ${selectedDate.getDate()}.`;

            const [year, monthNum] = month.split('-');
            const daysInMonth = new Date(year, monthNum, 0).getDate();

            // ì†Œì •ê·¼ë¡œì‹œê°„ì—ì„œ ì‹¤ ê·¼ë¡œì‹œê°„ ê³„ì‚°
            let actualWorkHours = workHours;
            if (shortHours > 0 && workHours.includes('~')) {
                const [startTime, endTime] = workHours.split('~');
                const [endHour, endMin] = endTime.split(':');
                const newEndHour = parseInt(endHour) - shortHours;
                actualWorkHours = `${startTime}~${String(newEndHour).padStart(2, '0')}:${endMin}`;
            }

            let tableRows = '';
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, monthNum - 1, day);
                const dayOfWeek = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][date.getDay()];
                const isWeekend = date.getDay() === 0 || date.getDay() === 6;
                
                tableRows += `
                    <tr>
                        <td>${month}-${String(day).padStart(2, '0')}</td>
                        <td>${dayOfWeek}</td>
                        <td>${isWeekend ? '-' : workHours}</td>
                        <td>${isWeekend ? '-' : (shortHours > 0 ? actualWorkHours : '-')}</td>
                        <td style="width: 80px;">${isWeekend ? '-' : 'â˜'}</td>
                    </tr>
                `;
            }

            const hasShortening = shortHours > 0;
            const shortInfo = hasShortening ? ` / ${shortReason || 'ê·¼ë¡œì‹œê°„ ë‹¨ì¶•'} (${shortHours}ì‹œê°„)` : '';

            const html = `
                <div class="print-area active-print" data-document-type="attendance">
                    <div class="print-header">
                        <h1>ê·¼ íƒœ í™• ì¸ ì„œ</h1>
                        <p style="font-size: 13pt; margin-top: 10px;">(${workType}${shortInfo})</p>
                    </div>
                    <div class="print-content">
                        <p style="margin: 20px 0; font-size: 13pt;">
                            <strong>ì„± ëª…:</strong> ${emp.name} &nbsp;&nbsp;&nbsp;&nbsp; 
                            <strong>ë¶€ ì„œ:</strong> ${emp.dept || '-'} &nbsp;&nbsp;&nbsp;&nbsp; 
                            <strong>ì§ ì±…:</strong> ${emp.position || '-'}
                        </p>
                        <p style="margin: 20px 0; font-size: 13pt;">
                            <strong>ëŒ€ìƒê¸°ê°„:</strong> ${year}ë…„ ${monthNum}ì›”
                        </p>
                        <table class="print-table">
                            <thead>
                                <tr>
                                    <th style="width: 20%;">ë‚ ì§œ</th>
                                    <th style="width: 10%;">ìš”ì¼</th>
                                    <th style="width: ${hasShortening ? '25%' : '45%'};">ì†Œì •ê·¼ë¡œì‹œê°„</th>
                                    ${hasShortening ? '<th style="width: 25%;">ì‹¤ ê·¼ë¡œì‹œê°„</th>' : ''}
                                    <th style="width: 20%;">í™•ì¸(âœ“)</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${tableRows}
                            </tbody>
                        </table>
                        <p style="margin-top: 40px; font-size: 11pt; line-height: 1.8;">
                            â€» ë³¸ ê·¼ë¡œìëŠ” <strong>${workType}</strong>ì— ë”°ë¥¸ <strong>ê°„ì£¼ê·¼ë¡œì‹œê°„ì œ í•©ì˜</strong>ì— ë”°ë¼ ê·¼ë¬´í•˜ì˜€ìœ¼ë©°,<br>
                            &nbsp;&nbsp;&nbsp;ìœ„ì™€ ê°™ì´ ì •ìƒ ê·¼ë¬´í•˜ì˜€ìŒì„ í™•ì¸í•©ë‹ˆë‹¤.
                        </p>
                        ${hasShortening ? `<p style="font-size: 11pt; margin-top: 10px;">â€» ${shortReason || 'ê·¼ë¡œì‹œê°„ ë‹¨ì¶•'} ì ìš©: ì†Œì •ê·¼ë¡œì‹œê°„ ${workHours}ì—ì„œ ì‹¤ ê·¼ë¡œì‹œê°„ ${actualWorkHours}ë¡œ ${shortHours}ì‹œê°„ ë‹¨ì¶•</p>` : ''}
                        <div class="print-signature">
                            <p style="font-size: 12pt;">${formattedDate}</p>
                            <p style="margin-top: 30px; font-size: 12pt;">ê·¼ë¡œì: ${emp.name} (ì¸)</p>
                            <p style="margin-top: 20px; font-size: 12pt;">í™•ì¸ì: ________________ (ì¸)</p>
                            <br>
                            <p style="font-size: 14pt; font-weight: 700; margin-top: 30px;">í”„ë ˆìŠ¤ì½”21</p>
                        </div>
                    </div>
                </div>
            `;

            // ê¸°ì¡´ ëª¨ë“  print-areaì—ì„œ active-print ì œê±°
            clearActivePrint();
            
            // ê¸°ì¡´ ë‚´ìš© ì™„ì „íˆ ì´ˆê¸°í™” í›„ ìƒˆë¡œ ìƒì„±
            const sheetDiv = document.getElementById('attendanceSheet');
            sheetDiv.innerHTML = html;
            
            // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì—…ë°ì´íŠ¸
            window.currentDocument = {
                type: 'attendance',
                title: `ê·¼íƒœí™•ì¸ì„œ_${emp.name}_${year}ë…„${monthNum}ì›”`,
                html: html
            };
        }

        // Kanban ì—…ë°ì´íŠ¸
        function updateKanban() {
            const todo = kanbanTasks.filter(t => t.status === 'todo');
            const doing = kanbanTasks.filter(t => t.status === 'doing');
            const done = kanbanTasks.filter(t => t.status === 'done');

            document.getElementById('kanbanTodo').innerHTML = todo.map(task => `
                <div class="kanban-card" draggable="true">
                    <div class="kanban-card-title">${task.title}</div>
                    <div class="kanban-card-meta">ğŸ‘¤ ${task.assignee}</div>
                </div>
            `).join('');

            document.getElementById('kanbanDoing').innerHTML = doing.map(task => `
                <div class="kanban-card" draggable="true">
                    <div class="kanban-card-title">${task.title}</div>
                    <div class="kanban-card-meta">ğŸ‘¤ ${task.assignee}</div>
                </div>
            `).join('');

            document.getElementById('kanbanDone').innerHTML = done.map(task => `
                <div class="kanban-card" draggable="true">
                    <div class="kanban-card-title">${task.title}</div>
                    <div class="kanban-card-meta">ğŸ‘¤ ${task.assignee}</div>
                </div>
            `).join('');

            // ë¯¸íŒ… ë¡œê·¸ ì—…ë°ì´íŠ¸
            document.getElementById('meetingLogs').innerHTML = meetingLogs.map(log => `
                <div class="alert-card info">
                    <div>
                        <strong>${log.title}</strong><br>
                        <small>${log.date} | ${log.attendees}</small>
                    </div>
                </div>
            `).join('');
        }

        // Kanban ì‘ì—… ì¶”ê°€ ëª¨ë‹¬
        function addKanbanTask() {
            document.getElementById('taskModal').classList.add('active');
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal() {
            document.getElementById('taskModal').classList.remove('active');
        }

        // Kanban ì‘ì—… ì €ì¥
        function saveKanbanTask() {
            const title = document.getElementById('taskTitle').value;
            const assignee = document.getElementById('taskAssignee').selectedOptions[0]?.text || '';
            const status = document.getElementById('taskStatus').value;

            if (!title) {
                alert('ì‘ì—… ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            kanbanTasks.push({
                id: Date.now(),
                title,
                assignee,
                status
            });

            saveData();
            updateKanban();
            closeModal();

            document.getElementById('taskTitle').value = '';
        }

        // ë¯¸íŒ… ë¡œê·¸ ì¶”ê°€
        function addMeetingLog() {
            const title = prompt('íšŒì˜ ì œëª©:');
            if (!title) return;

            const attendees = prompt('ì°¸ì„ì:');
            
            meetingLogs.push({
                id: Date.now(),
                title,
                attendees,
                date: new Date().toLocaleDateString('ko-KR')
            });

            saveData();
            updateKanban();
        }

        // ì¸ìˆ˜ì¸ê³„ ì €ì¥
        function saveHandover() {
            const empId = document.getElementById('handoverEmp').value;
            const successorId = document.getElementById('successorEmp').value;
            const content = document.getElementById('handoverContent').value;

            const emp = employees.find(e => e.id == empId);
            const successor = employees.find(e => e.id == successorId);

            if (!content) {
                alert('ì¸ìˆ˜ì¸ê³„ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            handovers.push({
                id: Date.now(),
                employee: emp.name,
                successor: successor.name,
                content,
                date: new Date().toLocaleDateString('ko-KR')
            });

            saveData();
            alert('ì¸ìˆ˜ì¸ê³„ ë‚´ìš©ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            document.getElementById('handoverContent').value = '';
        }

        // IT ìì‚° ì¶”ê°€
        function addITAsset() {
            const type = prompt('ìì‚° êµ¬ë¶„ (ë…¸íŠ¸ë¶/ì†Œí”„íŠ¸ì›¨ì–´/ê³„ì •):');
            const name = prompt('ëª¨ë¸ëª…/ì œí’ˆëª…:');
            const serial = prompt('ì‹œë¦¬ì–¼ë²ˆí˜¸/ë¼ì´ì„ ìŠ¤:');
            
            if (!type || !name) return;

            itAssets.push({
                id: Date.now(),
                type,
                name,
                serial: serial || '-',
                assignee: 'ë¯¸í• ë‹¹',
                status: 'ì‚¬ìš©ê°€ëŠ¥'
            });

            saveData();
            updateITAssetTable();
        }

        // IT ìì‚° í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateITAssetTable() {
            const tbody = document.getElementById('itAssetTable');
            tbody.innerHTML = itAssets.map(asset => `
                <tr>
                    <td>${asset.type}</td>
                    <td>${asset.name}</td>
                    <td>${asset.serial}</td>
                    <td>${asset.assignee}</td>
                    <td><span class="badge badge-success">${asset.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline" onclick="deleteAsset(${asset.id})">ì‚­ì œ</button>
                    </td>
                </tr>
            `).join('');
        }

        // IT ìì‚° ì‚­ì œ
        function deleteAsset(id) {
            if (confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                itAssets = itAssets.filter(a => a.id !== id);
                saveData();
                updateITAssetTable();
            }
        }

        // ì¦ëª…ì„œ ìƒì„±
        function generateCertificate() {
            const empId = document.getElementById('certEmpSelect').value;
            const certType = document.getElementById('certType').value;
            const certDate = document.getElementById('certDate').value;
            const emp = employees.find(e => e.id == empId);

            if (!emp) {
                alert('ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë°œê¸‰ì¼ (ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ëŠ˜)
            const selectedDate = certDate ? new Date(certDate) : new Date();
            const today = selectedDate;
            
            const joinDate = new Date(emp.joinDate);
            const years = Math.floor((today - joinDate) / (365.25 * 24 * 60 * 60 * 1000));
            const months = Math.floor(((today - joinDate) % (365.25 * 24 * 60 * 60 * 1000)) / (30.44 * 24 * 60 * 60 * 1000));

            let content = '';
            if (certType === 'ì¬ì§') {
                content = `
                    <div class="print-area active-print" data-document-type="certificate">
                        <div class="print-header">
                            <h1>ì¬ ì§ ì¦ ëª… ì„œ</h1>
                        </div>
                        <div class="print-content">
                            <p style="text-align: center; margin: 50px 0 60px 0; font-size: 13pt; line-height: 2;">
                                ì•„ë˜ ì‚¬ëŒì€ ë³¸ ì‚¬ì—…ì¥ì— ì¬ì§ ì¤‘ì„ì„ ì¦ëª…í•©ë‹ˆë‹¤.
                            </p>
                            <table style="width: 100%; margin: 50px auto; max-width: 500px; border-collapse: collapse;">
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; width: 35%; font-weight: 700; font-size: 12pt;">ì„± ëª…</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.name}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; font-weight: 700; font-size: 12pt;">ìƒë…„ì›”ì¼</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.birthDate || '-'}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; font-weight: 700; font-size: 12pt;">ë¶€ ì„œ</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.dept || '-'}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; font-weight: 700; font-size: 12pt;">ì§ ì±…</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.position || '-'}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; font-weight: 700; font-size: 12pt;">ì…ì‚¬ì¼</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.joinDate}</td>
                                </tr>
                            </table>
                            <p style="text-align: center; margin: 60px 0 80px 0; font-size: 13pt; line-height: 2;">
                                ìœ„ì™€ ê°™ì´ ì¦ëª…í•©ë‹ˆë‹¤.
                            </p>
                            <div class="print-signature" style="text-align: center;">
                                <p style="font-size: 13pt; margin-bottom: 50px;">${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼</p>
                                <p style="font-size: 18pt; font-weight: 700; margin-bottom: 15px;">í”„ë ˆìŠ¤ì½”21</p>
                                <p style="font-size: 13pt;">ëŒ€í‘œ &nbsp;&nbsp; ì´ ì§„ ì„  &nbsp;&nbsp; (ì¸)</p>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                content = `
                    <div class="print-area active-print" data-document-type="certificate">
                        <div class="print-header">
                            <h1>ê²½ ë ¥ ì¦ ëª… ì„œ</h1>
                        </div>
                        <div class="print-content">
                            <p style="text-align: center; margin: 50px 0 60px 0; font-size: 13pt; line-height: 2;">
                                ì•„ë˜ ì‚¬ëŒì˜ ê²½ë ¥ì„ ì¦ëª…í•©ë‹ˆë‹¤.
                            </p>
                            <table style="width: 100%; margin: 50px auto; max-width: 500px; border-collapse: collapse;">
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; width: 35%; font-weight: 700; font-size: 12pt;">ì„± ëª…</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.name}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; font-weight: 700; font-size: 12pt;">ìƒë…„ì›”ì¼</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.birthDate || '-'}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; font-weight: 700; font-size: 12pt;">ê·¼ë¬´ê¸°ê°„</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.joinDate} ~ í˜„ì¬ (${years}ë…„ ${months}ê°œì›”)</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; font-weight: 700; font-size: 12pt;">ì§ ì±…</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.position || '-'}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 15px; border: 1px solid #333; background: #f8f8f8; font-weight: 700; font-size: 12pt;">ë‹´ë‹¹ì—…ë¬´</td>
                                    <td style="padding: 15px; border: 1px solid #333; font-size: 12pt;">${emp.dept ? emp.dept + ' ì—…ë¬´ ì „ë°˜' : 'ì—…ë¬´ ì „ë°˜'}</td>
                                </tr>
                            </table>
                            <p style="text-align: center; margin: 60px 0 80px 0; font-size: 13pt; line-height: 2;">
                                ìœ„ì™€ ê°™ì´ ì¦ëª…í•©ë‹ˆë‹¤.
                            </p>
                            <div class="print-signature" style="text-align: center;">
                                <p style="font-size: 13pt; margin-bottom: 50px;">${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼</p>
                                <p style="font-size: 18pt; font-weight: 700; margin-bottom: 15px;">í”„ë ˆìŠ¤ì½”21</p>
                                <p style="font-size: 13pt;">ëŒ€í‘œ &nbsp;&nbsp; ì´ ì§„ ì„  &nbsp;&nbsp; (ì¸)</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            // ê¸°ì¡´ ëª¨ë“  print-areaì—ì„œ active-print ì œê±°
            clearActivePrint();
            
            // ê¸°ì¡´ ë‚´ìš© ì™„ì „íˆ ì´ˆê¸°í™” í›„ ìƒˆë¡œ ìƒì„±
            const certDiv = document.getElementById('certificateView');
            certDiv.innerHTML = content;
            
            // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì—…ë°ì´íŠ¸
            window.currentDocument = {
                type: certType,
                title: `${certType === 'ì¬ì§' ? 'ì¬ì§ì¦ëª…ì„œ' : 'ê²½ë ¥ì¦ëª…ì„œ'}_${emp.name}`,
                html: content
            };
        }

        // ì´ìŠˆ ë¡œê·¸ ì €ì¥
        function saveIssueLog() {
            const empId = document.getElementById('issueEmpSelect').value;
            const type = document.getElementById('issueType').value;
            const content = document.getElementById('issueContent').value;

            const emp = employees.find(e => e.id == empId);

            if (!content) {
                alert('ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            issueLogs.push({
                id: Date.now(),
                date: new Date().toLocaleDateString('ko-KR'),
                employee: emp.name,
                type,
                content
            });

            saveData();
            updateIssueTable();
            document.getElementById('issueContent').value = '';
            alert('ì´ìŠˆê°€ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ì´ìŠˆ í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateIssueTable() {
            const tbody = document.getElementById('issueLogTable');
            tbody.innerHTML = issueLogs.map(issue => `
                <tr>
                    <td>${issue.date}</td>
                    <td>${issue.employee}</td>
                    <td><span class="badge badge-warning">${issue.type}</span></td>
                    <td>${issue.content.substring(0, 30)}...</td>
                </tr>
            `).join('');
        }

        // ë²•ì  ì„œì‹ ìƒì„±
        function generateLegalForm() {
            const formType = document.getElementById('formType').value;
            const empId = document.getElementById('formEmpSelect').value;
            const legalFormDate = document.getElementById('legalFormDate').value;
            const emp = employees.find(e => e.id == empId);

            if (!emp) {
                alert('ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì„œì‹ ì‘ì„±ì¼ (ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ëŠ˜)
            const selectedDate = legalFormDate ? new Date(legalFormDate) : new Date();
            const today = selectedDate;
            const todayStr = `${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼`;
            
            const futureDate = new Date(today);
            futureDate.setDate(futureDate.getDate() + 30);
            const futureDateStr = `${futureDate.getFullYear()}ë…„ ${futureDate.getMonth() + 1}ì›” ${futureDate.getDate()}ì¼`;

            let content = '';

            switch(formType) {
                case 'ê²½ê³ ì¥':
                    content = `
                        <div class="print-area active-print" data-document-type="legal">
                            <div class="print-header">
                                <h1>ê²½ ê³  ì¥</h1>
                            </div>
                            <div class="print-content">
                                <p style="margin: 30px 0; font-size: 12pt;">
                                    <strong>ìˆ˜ì‹ :</strong> ${emp.name} (${emp.dept} ${emp.position})<br>
                                    <strong>ë°œì‹ :</strong> ëŒ€í‘œì´ì‚¬
                                </p>
                                <hr style="border: 1px solid #333; margin: 30px 0;">
                                <p style="font-size: 12pt; line-height: 2; margin: 40px 0;">
                                    ê·€í•˜ëŠ” <strong style="text-decoration: underline;">[êµ¬ì²´ì  ì‚¬ìœ ë¥¼ ê¸°ì¬í•˜ì‹œì˜¤]</strong>ë¡œ ì¸í•˜ì—¬ 
                                    íšŒì‚¬ì˜ ì·¨ì—…ê·œì¹™ ì œâ—‹ì¡° (ë³µë¬´ê·œì •)ë¥¼ ìœ„ë°˜í•˜ì˜€ìŠµë‹ˆë‹¤.
                                </p>
                                <p style="font-size: 12pt; line-height: 2; margin: 40px 0;">
                                    ì´ì— ê·€í•˜ì—ê²Œ <strong style="color: #d00;">ê²½ê³ </strong>ë¥¼ ë°œí•˜ì˜¤ë‹ˆ, í–¥í›„ ë™ì¼í•œ í–‰ìœ„ê°€ 
                                    ì¬ë°œí•˜ì§€ ì•Šë„ë¡ ê°ë³„íˆ ìœ ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
                                </p>
                                <p style="font-size: 12pt; line-height: 2; margin: 40px 0;">
                                    ë§Œì¼ ë™ì¼ ë˜ëŠ” ìœ ì‚¬í•œ ì‚¬ì•ˆì´ ì¬ë°œí•  ê²½ìš°, ì·¨ì—…ê·œì¹™ì— ë”°ë¼ 
                                    <strong>ê°ë´‰, ì •ì§, í•´ê³  ë“±</strong>ì˜ ì§•ê³„ ì¡°ì¹˜ê°€ ì·¨í•´ì§ˆ ìˆ˜ ìˆìŒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.
                                </p>
                                <div class="print-signature" style="margin-top: 80px;">
                                    <p style="text-align: right; font-size: 12pt;">${todayStr}</p>
                                    <p style="text-align: right; font-size: 14pt; margin-top: 30px; font-weight: 700;">í”„ë ˆìŠ¤ì½”21</p>
                                    <p style="text-align: right; font-size: 12pt; margin-top: 10px;">ëŒ€í‘œ ì´ì§„ì„  (ì¸)</p>
                                </div>
                                <hr style="border: 1px dashed #999; margin: 50px 0;">
                                <p style="text-align: center; font-size: 11pt; margin: 30px 0;">ìœ„ ë‚´ìš©ì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
                                <p style="text-align: center; font-size: 12pt; margin-top: 40px;">
                                    í™•ì¸ì¼ì: __________<br><br>
                                    í™•ì¸ì: ${emp.name} (ì¸)
                                </p>
                            </div>
                        </div>
                    `;
                    break;
                case 'ì‹œë§ì„œ':
                    content = `
                        <div class="print-area active-print" data-document-type="legal">
                            <div class="print-header">
                                <h1>ì‹œ ë§ ì„œ</h1>
                            </div>
                            <div class="print-content">
                                <p style="margin: 30px 0; font-size: 12pt;">
                                    <strong>ì†Œ ì†:</strong> ${emp.dept}<br>
                                    <strong>ì§ì±…/ì„±ëª…:</strong> ${emp.position} ${emp.name}<br>
                                    <strong>ì‘ì„±ì¼ì:</strong> ${todayStr}
                                </p>
                                <hr style="border: 1px solid #333; margin: 30px 0;">
                                <div style="margin: 40px 0;">
                                    <p style="font-size: 13pt; font-weight: 700; margin-bottom: 15px;">1. ì‚¬ê³  ê²½ìœ„</p>
                                    <div style="border: 1px solid #999; min-height: 150px; padding: 15px; background: #fafafa;">
                                        <p style="color: #999; font-size: 11pt;">[êµ¬ì²´ì ì¸ ì‚¬ê³  ê²½ìœ„ë¥¼ ìƒì„¸íˆ ê¸°ì¬í•˜ì‹œì˜¤]</p>
                                    </div>
                                </div>
                                <div style="margin: 40px 0;">
                                    <p style="font-size: 13pt; font-weight: 700; margin-bottom: 15px;">2. ë°˜ì„± ë° ê°œì„  ë°©ì•ˆ</p>
                                    <div style="border: 1px solid #999; min-height: 150px; padding: 15px; background: #fafafa;">
                                        <p style="color: #999; font-size: 11pt;">[ë°˜ì„± ë‚´ìš©ê³¼ í–¥í›„ ì¬ë°œ ë°©ì§€ë¥¼ ìœ„í•œ ê°œì„  ë°©ì•ˆì„ ê¸°ì¬í•˜ì‹œì˜¤]</p>
                                    </div>
                                </div>
                                <div class="print-signature" style="margin-top: 80px; text-align: center;">
                                    <p style="font-size: 12pt; margin-bottom: 50px;">${todayStr}</p>
                                    <p style="font-size: 13pt;">ì‘ì„±ì: <strong>${emp.name}</strong> (ì¸)</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'ê¶Œê³ ì‚¬ì§':
                    content = `
                        <div class="print-area active-print" data-document-type="legal">
                            <div class="print-header">
                                <h1>ê¶Œ ê³  ì‚¬ ì§ ì„œ</h1>
                            </div>
                            <div class="print-content">
                                <p style="margin: 30px 0; font-size: 12pt;">
                                    <strong>ìˆ˜ì‹ :</strong> ${emp.name} (${emp.dept} ${emp.position})
                                </p>
                                <hr style="border: 1px solid #333; margin: 30px 0;">
                                <p style="font-size: 12pt; line-height: 2.2; margin: 40px 0;">
                                    íšŒì‚¬ëŠ” ì•„ë˜ì˜ ì‚¬ìœ ë¡œ ê·€í•˜ì—ê²Œ <strong>ì‚¬ì§ì„ ê¶Œê³ </strong>í•©ë‹ˆë‹¤.
                                </p>
                                <div style="margin: 40px 0; padding: 20px; border: 2px solid #333;">
                                    <p style="font-size: 13pt; font-weight: 700; margin-bottom: 15px;">ã€ ê¶Œê³ ì‚¬ì§ ì‚¬ìœ  ã€‘</p>
                                    <p style="font-size: 12pt; line-height: 2; min-height: 100px;">
                                        [êµ¬ì²´ì  ì‚¬ìœ ë¥¼ ê¸°ì¬í•˜ì‹œì˜¤]<br><br>
                                        ì˜ˆ) ì—…ë¬´ ì„±ê³¼ ë¶€ì§„, ì¡°ì§ ì ì‘ ì‹¤íŒ¨, ê²½ì˜ìƒ í•„ìš” ë“±
                                    </p>
                                </div>
                                <p style="font-size: 12pt; line-height: 2.2; margin: 40px 0;">
                                    ê·€í•˜ê°€ ë³¸ ê¶Œê³ ë¥¼ ìˆ˜ìš©í•˜ì‹¤ ê²½ìš°, ì•„ë˜ ì¡°ê±´ìœ¼ë¡œ í‡´ì§ ì²˜ë¦¬ë©ë‹ˆë‹¤.
                                </p>
                                <table style="width: 100%; border-collapse: collapse; margin: 30px 0;">
                                    <tr>
                                        <td style="border: 1px solid #333; padding: 12px; background: #f0f0f0; width: 30%; font-weight: 700;">í‡´ì§ ì˜ˆì •ì¼</td>
                                        <td style="border: 1px solid #333; padding: 12px;">${futureDateStr}</td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #333; padding: 12px; background: #f0f0f0; font-weight: 700;">í‡´ì§ê¸ˆ</td>
                                        <td style="border: 1px solid #333; padding: 12px;">ê·¼ë¡œê¸°ì¤€ë²•ì— ë”°ë¼ ì§€ê¸‰</td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #333; padding: 12px; background: #f0f0f0; font-weight: 700;">ìœ„ë¡œê¸ˆ</td>
                                        <td style="border: 1px solid #333; padding: 12px;">ë³„ë„ í˜‘ì˜</td>
                                    </tr>
                                </table>
                                <p style="font-size: 11pt; line-height: 1.8; margin: 30px 0; color: #666;">
                                    â€» ë³¸ ê¶Œê³ ë¥¼ ìˆ˜ìš©í•˜ì§€ ì•Šì„ ê²½ìš°, íšŒì‚¬ëŠ” ì·¨ì—…ê·œì¹™ì— ë”°ë¥¸ ì ˆì°¨ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                </p>
                                <div class="print-signature" style="margin-top: 80px;">
                                    <p style="text-align: right; font-size: 12pt;">${todayStr}</p>
                                    <p style="text-align: right; font-size: 14pt; margin-top: 30px; font-weight: 700;">í”„ë ˆìŠ¤ì½”21</p>
                                    <p style="text-align: right; font-size: 12pt; margin-top: 10px;">ëŒ€í‘œ ì´ì§„ì„  (ì¸)</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'í•´ê³ ì˜ˆê³ ':
                    content = `
                        <div class="print-area active-print" data-document-type="legal">
                            <div class="print-header">
                                <h1>í•´ ê³  ì˜ˆ ê³  í†µ ë³´ ì„œ</h1>
                            </div>
                            <div class="print-content">
                                <p style="margin: 30px 0; font-size: 12pt;">
                                    <strong>ìˆ˜ì‹ :</strong> ${emp.name} (${emp.dept} ${emp.position})
                                </p>
                                <hr style="border: 1px solid #333; margin: 30px 0;">
                                <p style="font-size: 12pt; line-height: 2.2; margin: 40px 0;">
                                    <strong>ê·¼ë¡œê¸°ì¤€ë²• ì œ26ì¡°</strong>ì— ì˜ê±°í•˜ì—¬, ê·€í•˜ì—ê²Œ í•´ê³ ë¥¼ ì˜ˆê³ í•©ë‹ˆë‹¤.
                                </p>
                                <table style="width: 100%; border-collapse: collapse; margin: 40px 0;">
                                    <tr>
                                        <td style="border: 1px solid #333; padding: 15px; background: #f0f0f0; width: 30%; font-weight: 700; font-size: 12pt;">í•´ê³  ì‚¬ìœ </td>
                                        <td style="border: 1px solid #333; padding: 15px; font-size: 12pt;">
                                            [êµ¬ì²´ì  ì‚¬ìœ ë¥¼ ê¸°ì¬í•˜ì‹œì˜¤]<br>
                                            <span style="font-size: 10pt; color: #666;">
                                            ì˜ˆ) ì·¨ì—…ê·œì¹™ ì œâ—‹ì¡° ìœ„ë°˜, ë¬´ë‹¨ê²°ê·¼ â—‹ì¼, ì—…ë¬´ìƒ ì¤‘ëŒ€í•œ ê³¼ì‹¤ ë“±
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #333; padding: 15px; background: #f0f0f0; font-weight: 700; font-size: 12pt;">í†µë³´ì¼</td>
                                        <td style="border: 1px solid #333; padding: 15px; font-size: 12pt;">${todayStr}</td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #333; padding: 15px; background: #f0f0f0; font-weight: 700; font-size: 12pt;">í•´ê³  ì˜ˆì •ì¼</td>
                                        <td style="border: 1px solid #333; padding: 15px; font-size: 12pt;"><strong style="color: #d00;">${futureDateStr}</strong> (í†µë³´ì¼ë¡œë¶€í„° 30ì¼ í›„)</td>
                                    </tr>
                                </table>
                                <div style="border: 2px solid #d00; padding: 20px; margin: 40px 0; background: #fff5f5;">
                                    <p style="font-size: 13pt; font-weight: 700; margin-bottom: 15px; color: #d00;">ã€ ì´ì˜ ì‹ ì²­ ì•ˆë‚´ ã€‘</p>
                                    <p style="font-size: 11pt; line-height: 2;">
                                        â€¢ ë³¸ í†µë³´ì— ì´ì˜ê°€ ìˆì„ ê²½ìš°, <strong>í†µë³´ì¼ë¡œë¶€í„° 7ì¼ ì´ë‚´</strong>ì— ì´ì˜ì‹ ì²­ì„œë¥¼ ì œì¶œí•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.<br>
                                        â€¢ ì´ì˜ì‹ ì²­ì„œëŠ” ì¸ì‚¬íŒ€ì— ì„œë©´ìœ¼ë¡œ ì œì¶œí•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.<br>
                                        â€¢ ì •ë‹¹í•œ ì‚¬ìœ  ì—†ì´ ê¸°í•œ ë‚´ ì´ì˜ì‹ ì²­ì„ í•˜ì§€ ì•Šì„ ê²½ìš°, ë³¸ í†µë³´ ë‚´ìš©ì— ë™ì˜í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.
                                    </p>
                                </div>
                                <p style="font-size: 11pt; line-height: 1.8; margin: 30px 0; color: #666;">
                                    â€» ê·¼ë¡œê¸°ì¤€ë²• ì œ26ì¡°: ì‚¬ìš©ìëŠ” ê·¼ë¡œìë¥¼ í•´ê³ í•˜ë ¤ë©´ ì ì–´ë„ 30ì¼ ì „ì— ì˜ˆê³ í•˜ê±°ë‚˜, 
                                    30ì¼ë¶„ ì´ìƒì˜ í†µìƒì„ê¸ˆì„ ì§€ê¸‰í•˜ì—¬ì•¼ í•œë‹¤.
                                </p>
                                <div class="print-signature" style="margin-top: 80px;">
                                    <p style="text-align: right; font-size: 12pt;">${todayStr}</p>
                                    <p style="text-align: right; font-size: 14pt; margin-top: 30px; font-weight: 700;">í”„ë ˆìŠ¤ì½”21</p>
                                    <p style="text-align: right; font-size: 12pt; margin-top: 10px;">ëŒ€í‘œ ì´ì§„ì„  (ì¸)</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
            }

            // ê¸°ì¡´ ëª¨ë“  print-areaì—ì„œ active-print ì œê±°
            clearActivePrint();
            
            // ê¸°ì¡´ ë‚´ìš© ì™„ì „íˆ ì´ˆê¸°í™” í›„ ìƒˆë¡œ ìƒì„±
            const formDiv = document.getElementById('legalFormView');
            formDiv.innerHTML = content;
            
            // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì—…ë°ì´íŠ¸
            const formTitles = {
                'ê²½ê³ ì¥': 'ê²½ê³ ì¥',
                'ì‹œë§ì„œ': 'ì‹œë§ì„œ',
                'ê¶Œê³ ì‚¬ì§': 'ê¶Œê³ ì‚¬ì§ì„œ',
                'í•´ê³ ì˜ˆê³ ': 'í•´ê³ ì˜ˆê³ í†µë³´ì„œ'
            };
            window.currentDocument = {
                type: 'legal',
                title: `${formTitles[formType]}_${emp.name}`,
                html: content
            };
        }

        // ê±´ê°•ê²€ì§„ ëŒ€ìƒì í™•ì¸
        function checkHealthExam() {
            const currentYear = new Date().getFullYear();
            const targets = employees.filter(emp => {
                const birthYear = new Date(emp.birthDate).getFullYear();
                return birthYear % 2 === currentYear % 2;
            });

            const html = targets.length > 0 ? `
                <div class="result-box warning">
                    <h4>ğŸ“‹ ${currentYear}ë…„ ê±´ê°•ê²€ì§„ ëŒ€ìƒì (${targets.length}ëª…)</h4>
                    <ul style="margin-top: 15px; line-height: 2;">
                        ${targets.map(emp => `<li>${emp.name} (${emp.dept}) - ì¶œìƒ: ${emp.birthDate}</li>`).join('')}
                    </ul>
                    <p style="margin-top: 15px; font-size: 13px; color: var(--text-light);">
                        â€» ì¼ë°˜ ê±´ê°•ê²€ì§„ì€ ì¶œìƒì—°ë„ ê¸°ì¤€ í™€/ì§ìˆ˜ë…„ì— ì‹¤ì‹œí•©ë‹ˆë‹¤.
                    </p>
                </div>
            ` : `
                <div class="result-box">
                    <p>âœ… ${currentYear}ë…„ë„ ê±´ê°•ê²€ì§„ ëŒ€ìƒìê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            `;

            document.getElementById('healthExamList').innerHTML = html;
        }

        // ê²½ì¡°ì‚¬ ê³„ì‚°
        function calculateEvent() {
            const eventType = document.getElementById('eventType').value;
            
            const events = {
                'ë³¸ì¸ê²°í˜¼': { leave: 5, support: 500000 },
                'ìë…€ê²°í˜¼': { leave: 1, support: 300000 },
                'ë¶€ëª¨ìƒ': { leave: 5, support: 300000 },
                'ë°°ìš°ìë¶€ëª¨ìƒ': { leave: 3, support: 200000 },
                'ì¶œì‚°': { leave: 10, support: 0 }
            };

            const event = events[eventType];

            document.getElementById('eventResult').innerHTML = `
                <div class="result-box success">
                    <div class="result-item">
                        <span class="result-label">ê²½ì¡°íœ´ê°€</span>
                        <span class="result-value">${event.leave}ì¼</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ê²½ì¡°ê¸ˆ ì§€ì›</span>
                        <span class="result-value">${event.support.toLocaleString()}ì›</span>
                    </div>
                </div>
            `;
        }

        // ì´ìŠˆ ë¡œê·¸ ì¶”ê°€
        function addIssueLog() {
            alert('ì´ìŠˆ ì •ë³´ë¥¼ ì…ë ¥í•œ í›„ ì €ì¥ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
        }

        // ========== ì„œì‹ ê²¹ì¹¨ ë°©ì§€ ==========
        
        // ëª¨ë“  print-areaì—ì„œ active-print í´ë˜ìŠ¤ ì œê±°
        function clearActivePrint() {
            document.querySelectorAll('.print-area').forEach(area => {
                area.classList.remove('active-print');
            });
        }

        // ì›Œë“œë¡œ í¸ì§‘ ê°€ëŠ¥í•œ HTML íŒŒì¼ ë‹¤ìš´ë¡œë“œ (A4 ìµœì í™”)
        function downloadAsWord() {
            if (!window.currentDocument) {
                alert('ë¨¼ì € ì„œì‹ì„ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }

            const fullHtml = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${window.currentDocument.title}</title>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'ë§‘ì€ ê³ ë”•', 'Malgun Gothic', Arial, sans-serif;
            width: 210mm;
            margin: 0 auto;
            padding: 20mm;
            font-size: 12pt;
            line-height: 1.8;
            color: #000;
            background: white;
        }
        .print-area {
            width: 100%;
            min-height: auto;
            padding: 0;
            margin: 0;
            background: white;
        }
        .print-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid black;
            padding-bottom: 15px;
        }
        .print-header h1 {
            font-size: 28pt;
            margin-bottom: 10px;
            font-weight: 700;
        }
        .print-header p {
            font-size: 12pt;
            margin: 5px 0;
        }
        .print-content {
            font-size: 12pt;
            line-height: 2;
        }
        .print-content p {
            margin: 10px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            table-layout: fixed;
        }
        table th, table td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
            font-size: 11pt;
            word-wrap: break-word;
        }
        table th {
            background-color: #f0f0f0;
            font-weight: 700;
        }
        .print-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .print-table th, .print-table td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
            font-size: 11pt;
        }
        .print-table th {
            background-color: #f0f0f0;
            font-weight: 700;
        }
        .print-signature {
            margin-top: 50px;
            text-align: right;
            font-size: 12pt;
        }
        .print-signature p {
            margin: 15px 0;
            line-height: 1.8;
        }
        hr {
            border: 1px solid #333;
            margin: 20px 0;
        }
        strong {
            font-weight: 700;
        }
    </style>
</head>
<body>
    ${window.currentDocument.html.replace(/class="print-area active-print"/g, 'class="print-area"').replace(/data-document-type="[^"]*"/g, '')}
</body>
</html>`;

            const blob = new Blob([fullHtml], { type: 'application/msword;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `${window.currentDocument.title}.doc`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            alert('âœ… ì›Œë“œ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nâ€¢ MS Wordì—ì„œ ì—´ì–´ì„œ í¸ì§‘ ê°€ëŠ¥\nâ€¢ í•œê¸€(HWP)ì—ì„œë„ ì—´ë¦¼\nâ€¢ A4 ìš©ì§€ì— ìµœì í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤');
        }

        // ========== ê¸‰ì—¬ ê³„ì‚° ê³ ë„í™” ==========

        // ì§ì› ì„ íƒ ì‹œ ê¸‰ì—¬ ì •ë³´ ìë™ ë¡œë“œ
        function loadEmployeeSalary() {
            const empId = document.getElementById('payslipEmp').value;
            const emp = employees.find(e => e.id == empId);
            
            if (emp && emp.salary) {
                // ê¸°ë³¸ê¸‰ì„ ì´ ê¸‰ì—¬ì˜ 70%ë¡œ ê°€ì •
                const basicSalary = Math.floor(emp.salary * 0.7);
                document.getElementById('payBasic').value = basicSalary;
            }
        }

        // ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±
        function generatePayslip() {
            const empId = document.getElementById('payslipEmp').value;
            const month = document.getElementById('payslipMonth').value;
            const payslipDate = document.getElementById('payslipDate').value;
            const basicPay = parseInt(document.getElementById('payBasic').value) || 0;
            const overtimePay = parseInt(document.getElementById('payOvertime').value) || 0;
            const mealAllowance = parseInt(document.getElementById('payMeal').value) || 0;
            const etcPay = parseInt(document.getElementById('payEtc').value) || 0;

            const emp = employees.find(e => e.id == empId);
            if (!emp) {
                alert('ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë°œê¸‰ì¼ (ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ëŠ˜)
            const selectedDate = payslipDate ? new Date(payslipDate) : new Date();

            // ê³¼ì„¸ ëŒ€ìƒ ê¸‰ì—¬
            const taxableIncome = basicPay + overtimePay + etcPay;
            const totalIncome = taxableIncome + mealAllowance;

            // 4ëŒ€ë³´í—˜ ê³„ì‚° (2026ë…„ ê¸°ì¤€ ì˜ˆìƒ ìš”ìœ¨)
            const nationalPension = Math.floor(taxableIncome * 0.045); // êµ­ë¯¼ì—°ê¸ˆ 4.5%
            const healthInsurance = Math.floor(taxableIncome * 0.03545); // ê±´ê°•ë³´í—˜ 3.545%
            const longTermCare = Math.floor(healthInsurance * 0.1295); // ì¥ê¸°ìš”ì–‘ 12.95%
            const employmentIns = Math.floor(taxableIncome * 0.009); // ê³ ìš©ë³´í—˜ 0.9%

            const totalInsurance = nationalPension + healthInsurance + longTermCare + employmentIns;

            // ê°„ì´ì„¸ì•¡ ê³„ì‚° (ë‹¨ìˆœí™”ëœ ê³„ì‚°ì‹)
            let incomeTax = 0;
            const monthlyTaxable = taxableIncome - totalInsurance; // ì†Œë“ê³µì œ í›„
            
            // ê°„ì´ì„¸ì•¡í‘œ ì ìš© (ë¶€ì–‘ê°€ì¡± 1ëª… ê°€ì •)
            if (monthlyTaxable > 0) {
                if (monthlyTaxable <= 1060000) incomeTax = 0;
                else if (monthlyTaxable <= 2060000) incomeTax = Math.floor((monthlyTaxable - 1060000) * 0.06);
                else if (monthlyTaxable <= 4060000) incomeTax = 60000 + Math.floor((monthlyTaxable - 2060000) * 0.15);
                else if (monthlyTaxable <= 8860000) incomeTax = 360000 + Math.floor((monthlyTaxable - 4060000) * 0.24);
                else incomeTax = 1512000 + Math.floor((monthlyTaxable - 8860000) * 0.35);
            }

            const localIncomeTax = Math.floor(incomeTax * 0.1); // ì§€ë°©ì†Œë“ì„¸ 10%
            const totalTax = incomeTax + localIncomeTax;

            // ì´ ê³µì œì•¡
            const totalDeduction = totalInsurance + totalTax;

            // ì‹¤ìˆ˜ë ¹ì•¡
            const netPay = totalIncome - totalDeduction;

            // ë‚ ì§œ í¬ë§·
            const today = new Date();
            const [year, monthNum] = month.split('-');

            const html = `
                <div class="print-area active-print" data-document-type="payslip">
                    <div class="print-header">
                        <h1>ê¸‰ ì—¬ ëª… ì„¸ ì„œ</h1>
                        <p style="font-size: 12pt; margin-top: 10px;">${year}ë…„ ${monthNum}ì›”ë¶„</p>
                    </div>
                    <div class="print-content">
                        <table style="width: 100%; border-collapse: collapse; margin: 30px 0;">
                            <tr>
                                <td style="padding: 12px; border: 1px solid #333; background: #f8f8f8; width: 20%; font-weight: 700;">ì„±ëª…</td>
                                <td style="padding: 12px; border: 1px solid #333; width: 30%;">${emp.name}</td>
                                <td style="padding: 12px; border: 1px solid #333; background: #f8f8f8; width: 20%; font-weight: 700;">ë¶€ì„œ</td>
                                <td style="padding: 12px; border: 1px solid #333; width: 30%;">${emp.dept || '-'}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #333; background: #f8f8f8; font-weight: 700;">ì§ì±…</td>
                                <td style="padding: 12px; border: 1px solid #333;">${emp.position || '-'}</td>
                                <td style="padding: 12px; border: 1px solid #333; background: #f8f8f8; font-weight: 700;">ì§€ê¸‰ì¼</td>
                                <td style="padding: 12px; border: 1px solid #333;">${selectedDate.getFullYear()}ë…„ ${selectedDate.getMonth() + 1}ì›” ${selectedDate.getDate()}ì¼</td>
                            </tr>
                        </table>

                        <h3 style="margin: 30px 0 15px; padding-bottom: 10px; border-bottom: 2px solid #333;">ğŸ’° ì§€ê¸‰ ë‚´ì—­</h3>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ê¸°ë³¸ê¸‰</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${basicPay.toLocaleString()}ì›</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ì—°ì¥ê·¼ë¡œìˆ˜ë‹¹</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${overtimePay.toLocaleString()}ì›</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ê¸°íƒ€ìˆ˜ë‹¹</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${etcPay.toLocaleString()}ì›</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ì‹ëŒ€ (ë¹„ê³¼ì„¸)</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${mealAllowance.toLocaleString()}ì›</td>
                            </tr>
                            <tr style="background: #f0f0f0;">
                                <td style="padding: 12px; border: 2px solid #333; font-weight: 700; font-size: 13pt;">ì§€ê¸‰ ì´ì•¡</td>
                                <td style="padding: 12px; border: 2px solid #333; text-align: right; font-weight: 700; font-size: 13pt; color: #2563eb;">${totalIncome.toLocaleString()}ì›</td>
                            </tr>
                        </table>

                        <h3 style="margin: 30px 0 15px; padding-bottom: 10px; border-bottom: 2px solid #333;">ğŸ“‰ ê³µì œ ë‚´ì—­</h3>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">êµ­ë¯¼ì—°ê¸ˆ (4.5%)</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${nationalPension.toLocaleString()}ì›</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ê±´ê°•ë³´í—˜ (3.545%)</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${healthInsurance.toLocaleString()}ì›</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ì¥ê¸°ìš”ì–‘ë³´í—˜ (12.95%)</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${longTermCare.toLocaleString()}ì›</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ê³ ìš©ë³´í—˜ (0.9%)</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${employmentIns.toLocaleString()}ì›</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ì†Œë“ì„¸</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${incomeTax.toLocaleString()}ì›</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: 700;">ì§€ë°©ì†Œë“ì„¸</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; text-align: right;">${localIncomeTax.toLocaleString()}ì›</td>
                            </tr>
                            <tr style="background: #fff5f5;">
                                <td style="padding: 12px; border: 2px solid #333; font-weight: 700; font-size: 13pt;">ê³µì œ ì´ì•¡</td>
                                <td style="padding: 12px; border: 2px solid #333; text-align: right; font-weight: 700; font-size: 13pt; color: #ef4444;">${totalDeduction.toLocaleString()}ì›</td>
                            </tr>
                        </table>

                        <table style="width: 100%; border-collapse: collapse; margin: 40px 0 20px;">
                            <tr style="background: #dbeafe;">
                                <td style="padding: 20px; border: 3px solid #2563eb; font-weight: 700; font-size: 16pt; text-align: center;">ì‹¤ ìˆ˜ ë ¹ ì•¡</td>
                                <td style="padding: 20px; border: 3px solid #2563eb; font-weight: 700; font-size: 20pt; text-align: right; color: #2563eb;">${netPay.toLocaleString()}ì›</td>
                            </tr>
                        </table>

                        <p style="font-size: 10pt; color: #666; margin-top: 30px;">
                            â€» ë³¸ ëª…ì„¸ì„œëŠ” ${year}ë…„ ${monthNum}ì›”ë¶„ ê¸‰ì—¬ ì§€ê¸‰ ë‚´ì—­ì…ë‹ˆë‹¤.<br>
                            â€» 4ëŒ€ë³´í—˜ ìš”ìœ¨ ë° ê°„ì´ì„¸ì•¡ì€ 2026ë…„ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                            â€» ë¬¸ì˜ì‚¬í•­ì€ ì¸ì‚¬íŒ€ìœ¼ë¡œ ì—°ë½ ë°”ëë‹ˆë‹¤.
                        </p>

                        <div class="print-signature" style="margin-top: 60px; text-align: center;">
                            <p style="font-size: 14pt; font-weight: 700;">í”„ë ˆìŠ¤ì½”21</p>
                            <p style="font-size: 12pt; margin-top: 10px;">ëŒ€í‘œ ì´ì§„ì„ </p>
                        </div>
                    </div>
                </div>
            `;

            // ê¸°ì¡´ ëª¨ë“  print-areaì—ì„œ active-print ì œê±°
            clearActivePrint();
            
            // ê¸°ì¡´ ë‚´ìš© ì™„ì „íˆ ì´ˆê¸°í™” í›„ ìƒˆë¡œ ìƒì„±
            const payslipDiv = document.getElementById('payslipView');
            payslipDiv.innerHTML = html;
            
            // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì—…ë°ì´íŠ¸
            window.currentDocument = {
                type: 'payslip',
                title: `ê¸‰ì—¬ëª…ì„¸ì„œ_${emp.name}_${year}ë…„${monthNum}ì›”`,
                html: html
            };
        }

        // ========== ì‹¤ì œ ê·¼íƒœ ê´€ë¦¬ ê¸°ëŠ¥ ==========
        
        // ê·¼íƒœ íƒ­ ì „í™˜
        function switchAttTab(tabId) {
            document.querySelectorAll('#attendance .tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('#attendance .tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');

            // ì…€ë ‰íŠ¸ ë°•ìŠ¤ ì—…ë°ì´íŠ¸
            updateAllSelects();
            
            // í˜„ì¬ ë‚ ì§œ ì„¤ì •
            const today = new Date().toISOString().split('T')[0];
            if (document.getElementById('attCheckDate')) {
                document.getElementById('attCheckDate').value = today;
            }
            if (document.getElementById('leaveStart')) {
                document.getElementById('leaveStart').value = today;
                document.getElementById('leaveEnd').value = today;
            }
            if (document.getElementById('historyMonth')) {
                document.getElementById('historyMonth').value = today.substring(0, 7);
            }

            // ì—°ì°¨ í˜„í™© ì—…ë°ì´íŠ¸
            if (tabId === 'leaveManage') {
                updateLeaveStatus();
            }
        }

        // ì¶œí‡´ê·¼ ê¸°ë¡
        function recordAttendance() {
            const empId = document.getElementById('attCheckEmp').value;
            const date = document.getElementById('attCheckDate').value;
            const checkIn = document.getElementById('checkInTime').value;
            const checkOut = document.getElementById('checkOutTime').value;
            const note = document.getElementById('attNote').value;

            const emp = employees.find(e => e.id == empId);
            if (!emp) {
                alert('ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!date || !checkIn || !checkOut) {
                alert('ë‚ ì§œì™€ ì‹œê°„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê·¼ë¬´ ì‹œê°„ ê³„ì‚°
            const checkInDate = new Date(`${date}T${checkIn}`);
            const checkOutDate = new Date(`${date}T${checkOut}`);
            const workHours = (checkOutDate - checkInDate) / (1000 * 60 * 60);

            if (!emp.attendanceRecords) emp.attendanceRecords = [];

            // ê¸°ì¡´ ê¸°ë¡ í™•ì¸
            const existingIndex = emp.attendanceRecords.findIndex(r => r.date === date);
            const record = {
                date,
                checkIn,
                checkOut,
                workHours: workHours.toFixed(1),
                note
            };

            if (existingIndex >= 0) {
                emp.attendanceRecords[existingIndex] = record;
                alert('âœ… ì¶œí‡´ê·¼ ê¸°ë¡ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } else {
                emp.attendanceRecords.push(record);
                alert('âœ… ì¶œí‡´ê·¼ ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            saveData();
            document.getElementById('attNote').value = '';
        }

        // ì—°ì°¨ ì‚¬ìš© ê¸°ë¡
        function recordLeave() {
            const empId = document.getElementById('leaveEmp').value;
            const leaveType = document.getElementById('leaveType').value;
            const startDate = document.getElementById('leaveStart').value;
            const endDate = document.getElementById('leaveEnd').value;
            const reason = document.getElementById('leaveReason').value;

            const emp = employees.find(e => e.id == empId);
            if (!emp) {
                alert('ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!startDate || !endDate) {
                alert('ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì¼ìˆ˜ ê³„ì‚°
            const start = new Date(startDate);
            const end = new Date(endDate);
            let days = Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;

            // ë°˜ì°¨ë©´ 0.5ì¼
            if (leaveType === 'ë°˜ì°¨') {
                days = 0.5;
            }

            if (!emp.leaveRecords) emp.leaveRecords = [];
            if (!emp.usedLeave) emp.usedLeave = 0;

            emp.leaveRecords.push({
                id: Date.now(),
                type: leaveType,
                startDate,
                endDate,
                days,
                reason,
                date: new Date().toISOString()
            });

            // ì—°ì°¨/ë°˜ì°¨ë§Œ ì°¨ê°
            if (leaveType === 'ì—°ì°¨' || leaveType === 'ë°˜ì°¨') {
                emp.usedLeave += days;
            }

            saveData();
            updateLeaveStatus();
            
            document.getElementById('leaveReason').value = '';
            alert(`âœ… ${leaveType} ${days}ì¼ì´ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // ì—°ì°¨ í˜„í™© ì—…ë°ì´íŠ¸
        function updateLeaveStatus() {
            const empId = document.getElementById('leaveEmp').value;
            const emp = employees.find(e => e.id == empId);
            
            if (!emp) return;

            const totalLeave = emp.annualLeave || 15;
            const usedLeave = emp.usedLeave || 0;
            const remainLeave = totalLeave - usedLeave;

            let html = `
                <div class="result-box ${remainLeave < 3 ? 'danger' : 'success'}">
                    <h4 style="margin-bottom: 15px;">${emp.name}ë‹˜ì˜ ì—°ì°¨ í˜„í™©</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                        <div>
                            <div style="color: var(--text-light); font-size: 13px;">ì´ ì—°ì°¨</div>
                            <div style="font-size: 28px; font-weight: 700; color: var(--primary);">${totalLeave}ì¼</div>
                        </div>
                        <div>
                            <div style="color: var(--text-light); font-size: 13px;">ì‚¬ìš©</div>
                            <div style="font-size: 28px; font-weight: 700; color: var(--warning);">${usedLeave}ì¼</div>
                        </div>
                        <div>
                            <div style="color: var(--text-light); font-size: 13px;">ì”ì—¬</div>
                            <div style="font-size: 28px; font-weight: 700; color: ${remainLeave < 3 ? 'var(--danger)' : 'var(--success)'};">${remainLeave}ì¼</div>
                        </div>
                    </div>
            `;

            // ì—°ì°¨ ì‚¬ìš© ì´ë ¥
            if (emp.leaveRecords && emp.leaveRecords.length > 0) {
                html += `
                    <div style="margin-top: 30px;">
                        <h5 style="margin-bottom: 15px;">ğŸ“‹ ìµœê·¼ ì‚¬ìš© ë‚´ì—­</h5>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ì¢…ë¥˜</th>
                                    <th>ê¸°ê°„</th>
                                    <th>ì¼ìˆ˜</th>
                                    <th>ì‚¬ìœ </th>
                                    <th>ê´€ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody>
                `;

                emp.leaveRecords.slice(-10).reverse().forEach(leave => {
                    html += `
                        <tr>
                            <td><span class="badge badge-primary">${leave.type}</span></td>
                            <td>${leave.startDate}${leave.endDate !== leave.startDate ? ' ~ ' + leave.endDate : ''}</td>
                            <td>${leave.days}ì¼</td>
                            <td>${leave.reason || '-'}</td>
                            <td><button class="btn btn-sm btn-danger" onclick="deleteLeave(${emp.id}, ${leave.id})">ì‚­ì œ</button></td>
                        </tr>
                    `;
                });

                html += `
                            </tbody>
                        </table>
                    </div>
                `;
            }

            html += `</div>`;
            document.getElementById('leaveStatus').innerHTML = html;
        }

        // ì—°ì°¨ ê¸°ë¡ ì‚­ì œ
        function deleteLeave(empId, leaveId) {
            if (!confirm('ì´ ì—°ì°¨ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            const emp = employees.find(e => e.id == empId);
            if (!emp) return;

            const leaveIndex = emp.leaveRecords.findIndex(l => l.id == leaveId);
            if (leaveIndex >= 0) {
                const leave = emp.leaveRecords[leaveIndex];
                
                // ì—°ì°¨/ë°˜ì°¨ë©´ ì‚¬ìš©ì¼ìˆ˜ ë³µêµ¬
                if (leave.type === 'ì—°ì°¨' || leave.type === 'ë°˜ì°¨') {
                    emp.usedLeave -= leave.days;
                }

                emp.leaveRecords.splice(leaveIndex, 1);
                saveData();
                updateLeaveStatus();
                alert('âœ… ì—°ì°¨ ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ê·¼íƒœ ì´ë ¥ ì¡°íšŒ
        function loadAttHistory() {
            const empId = document.getElementById('historyEmp').value;
            const month = document.getElementById('historyMonth').value;
            
            const emp = employees.find(e => e.id == empId);
            if (!emp || !emp.attendanceRecords) {
                document.getElementById('attHistoryTable').innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 40px;">ê·¼íƒœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            const records = emp.attendanceRecords.filter(r => r.date.startsWith(month));

            if (records.length === 0) {
                document.getElementById('attHistoryTable').innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 40px;">í•´ë‹¹ ì›”ì˜ ê·¼íƒœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            let totalHours = 0;
            let html = `
                <table class="table">
                    <thead>
                        <tr>
                            <th>ë‚ ì§œ</th>
                            <th>ì¶œê·¼</th>
                            <th>í‡´ê·¼</th>
                            <th>ê·¼ë¬´ì‹œê°„</th>
                            <th>ë¹„ê³ </th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            records.sort((a, b) => b.date.localeCompare(a.date)).forEach(record => {
                totalHours += parseFloat(record.workHours);
                html += `
                    <tr>
                        <td>${record.date}</td>
                        <td>${record.checkIn}</td>
                        <td>${record.checkOut}</td>
                        <td><strong>${record.workHours}h</strong></td>
                        <td>${record.note || '-'}</td>
                        <td><button class="btn btn-sm btn-danger" onclick="deleteAttendance(${emp.id}, '${record.date}')">ì‚­ì œ</button></td>
                    </tr>
                `;
            });

            html += `
                    </tbody>
                    <tfoot>
                        <tr style="background: var(--bg); font-weight: 700;">
                            <td colspan="3">ì´ ê·¼ë¬´ì¼ìˆ˜: ${records.length}ì¼</td>
                            <td colspan="3">ì´ ê·¼ë¬´ì‹œê°„: ${totalHours.toFixed(1)}h</td>
                        </tr>
                    </tfoot>
                </table>
            `;

            document.getElementById('attHistoryTable').innerHTML = html;
        }

        // ì¶œí‡´ê·¼ ê¸°ë¡ ì‚­ì œ
        function deleteAttendance(empId, date) {
            if (!confirm('ì´ ì¶œí‡´ê·¼ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            const emp = employees.find(e => e.id == empId);
            if (!emp) return;

            const index = emp.attendanceRecords.findIndex(r => r.date === date);
            if (index >= 0) {
                emp.attendanceRecords.splice(index, 1);
                saveData();
                loadAttHistory();
                alert('âœ… ì¶œí‡´ê·¼ ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ========== ë°ì´í„° ë°±ì—…/ë³µì› ê¸°ëŠ¥ ==========
        
        // ë°ì´í„° ë‚´ë³´ë‚´ê¸° (JSON)
        function exportData() {
            const exportData = {
                version: '10.0',
                exportDate: new Date().toISOString(),
                employees: employees,
                kanbanTasks: kanbanTasks,
                meetingLogs: meetingLogs,
                issueLogs: issueLogs,
                itAssets: itAssets,
                handovers: handovers
            };

            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `HR-Backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            alert('âœ… ë°±ì—… íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (JSON)
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!importedData.version) {
                        alert('âš ï¸ ì˜¬ë°”ë¥¸ ë°±ì—… íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.');
                        return;
                    }

                    if (confirm('âš ï¸ í˜„ì¬ ë°ì´í„°ê°€ ëª¨ë‘ ëŒ€ì²´ë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        employees = importedData.employees || [];
                        kanbanTasks = importedData.kanbanTasks || [];
                        meetingLogs = importedData.meetingLogs || [];
                        issueLogs = importedData.issueLogs || [];
                        itAssets = importedData.itAssets || [];
                        handovers = importedData.handovers || [];

                        saveData();
                        updateDashboard();
                        updateEmployeeTable();
                        updateAllSelects();
                        updateDataCount();
                        updateKanban();
                        updateIssueTable();
                        updateITAssetTable();

                        alert('âœ… ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
                    }
                } catch (error) {
                    alert('âŒ íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                }
            };
            reader.readAsText(file);
            
            // íŒŒì¼ input ì´ˆê¸°í™”
            event.target.value = '';
        }

        // ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”
        function resetAllData() {
            if (confirm('âš ï¸âš ï¸âš ï¸ ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!')) {
                if (confirm('âš ï¸ ë§ˆì§€ë§‰ í™•ì¸: ë°±ì—…í•˜ì…¨ìŠµë‹ˆê¹Œ?')) {
                    localStorage.clear();
                    employees = [];
                    kanbanTasks = [];
                    meetingLogs = [];
                    issueLogs = [];
                    itAssets = [];
                    handovers = [];
                    
                    saveData();
                    location.reload();
                }
            }
        }

        // ë°ì´í„° í˜„í™© ì—…ë°ì´íŠ¸
        function updateDataCount() {
            if (document.getElementById('dataCountEmp')) {
                document.getElementById('dataCountEmp').textContent = employees.length;
                document.getElementById('dataCountKanban').textContent = kanbanTasks.length;
                document.getElementById('dataCountIssue').textContent = issueLogs.length;
            }
        }

        // ========== V11 Enhanced ì‹ ê·œ ê¸°ëŠ¥ ==========
        
        // ì€í–‰ ì´ì²´ìš© ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
        function downloadBankTransferExcel() {
            if (employees.length === 0) {
                alert('ë“±ë¡ëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth() + 1;
            
            // ì—‘ì…€ ë°ì´í„° ìƒì„±
            const data = employees.map(emp => {
                // í”„ë¦¬ëœì„œëŠ” 3.3% ì›ì²œì§•ìˆ˜
                let netPay = emp.baseSalary || 0;
                if (emp.empType === 'í”„ë¦¬ëœì„œ') {
                    const withholdingTax = Math.floor(netPay * 0.033);
                    netPay = netPay - withholdingTax;
                }
                
                return {
                    'ì´ë¦„': emp.name,
                    'ë¶€ì„œ': emp.dept || '-',
                    'ê³„ì¢Œë²ˆí˜¸': emp.bankAccount || 'ë¯¸ë“±ë¡',
                    'ì€í–‰ëª…': emp.bankName || '-',
                    'ì´ì²´ê¸ˆì•¡': netPay,
                    'ë¹„ê³ ': `${month}ì›” ê¸‰ì—¬`
                };
            });
            
            // XLSX ìƒì„±
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "ê¸‰ì—¬ì´ì²´");
            
            // ë‹¤ìš´ë¡œë“œ
            XLSX.writeFile(wb, `ê¸‰ì—¬ì´ì²´_${year}ë…„${month}ì›”.xlsx`);
            alert(`âœ… ì€í–‰ ì´ì²´ìš© ì—‘ì…€ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\níŒŒì¼ëª…: ê¸‰ì—¬ì´ì²´_${year}ë…„${month}ì›”.xlsx`);
        }
        
        // ì•ˆì „ì ê²€ ì¶œê·¼ ê¸°ë¡
        function recordSafetyCheckIn(empId) {
            const emp = employees.find(e => e.id == empId);
            if (!emp) return;
            
            const checks = [];
            document.querySelectorAll('.safety-checkbox:checked').forEach(cb => {
                checks.push(cb.value);
            });
            
            if (checks.length < 3) {
                alert('âš ï¸ ì•ˆì „ì ê²€ì„ ìµœì†Œ 3ê°œ ì´ìƒ ì²´í¬í•´ì£¼ì„¸ìš”!\n(ì¤‘ëŒ€ì¬í•´ì²˜ë²Œë²• ëŒ€ì‘)');
                return false;
            }
            
            const today = new Date();
            const timeStr = `${String(today.getHours()).padStart(2,'0')}:${String(today.getMinutes()).padStart(2,'0')}`;
            
            safetyChecks.push({
                id: Date.now(),
                empId: empId,
                empName: emp.name,
                date: today.toISOString().split('T')[0],
                time: timeStr,
                checks: checks,
                timestamp: today.toISOString()
            });
            
            saveData();
            alert(`âœ… ${emp.name}ë‹˜ ì¶œê·¼ ì²˜ë¦¬ ì™„ë£Œ!\n\nì•ˆì „ì ê²€ ${checks.length}ê°œ í•­ëª© ê¸°ë¡ë¨:\n${checks.map((c, i) => `${i+1}. ${c}`).join('\n')}`);
            return true;
        }
        
        // ì†Œëª¨í’ˆ ìš”ì²­ ì¶”ê°€
        function addSupplyRequest() {
            const empId = prompt('ì§ì› IDë¥¼ ì…ë ¥í•˜ì„¸ìš” (ìˆ«ì):');
            const emp = employees.find(e => e.id == parseInt(empId));
            
            if (!emp) {
                alert('ì§ì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const item = prompt('í•„ìš”í•œ ì†Œëª¨í’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”:\n(ì˜ˆ: ì½”íŒ…ì¥ê°‘, ë°•ìŠ¤í…Œì´í”„, ì•ˆì „ëª¨ ë“±)');
            if (!item) return;
            
            const qty = prompt('ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”:', '10');
            if (!qty) return;
            
            supplies.push({
                id: Date.now(),
                empId: emp.id,
                empName: emp.name,
                item: item,
                qty: parseInt(qty),
                status: 'pending',
                date: new Date().toISOString().split('T')[0]
            });
            
            saveData();
            alert(`âœ… ì†Œëª¨í’ˆ ìš”ì²­ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nìš”ì²­ì: ${emp.name}\ní’ˆëª©: ${item}\nìˆ˜ëŸ‰: ${qty}ê°œ\n\nê´€ë¦¬ìê°€ ìŠ¹ì¸í•  ë•Œê¹Œì§€ ëŒ€ê¸°í•©ë‹ˆë‹¤.`);
            updateSupplyList();
        }
        
        // ì†Œëª¨í’ˆ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateSupplyList() {
            const supplyTable = document.getElementById('supplyTable');
            if (!supplyTable) return;
            
            const pending = supplies.filter(s => s.status === 'pending');
            const approved = supplies.filter(s => s.status === 'approved');
            
            let html = '<h4 style="margin-top:20px;">ğŸ“¦ ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ (' + pending.length + 'ê±´)</h4>';
            if (pending.length > 0) {
                html += '<div style="margin-top:10px;">';
                pending.forEach(s => {
                    html += `
                        <div class="alert-card warning" style="display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <strong>${s.empName}</strong> - ${s.item} (${s.qty}ê°œ)
                                <br><small>${s.date}</small>
                            </div>
                            <button class="btn btn-sm btn-success" onclick="approveSupply(${s.id})">êµ¬ë§¤ ì™„ë£Œ</button>
                        </div>
                    `;
                });
                html += '</div>';
            } else {
                html += '<p style="color:var(--text-light); margin-top:10px;">ëŒ€ê¸° ì¤‘ì¸ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
            
            html += '<h4 style="margin-top:30px;">âœ… ì²˜ë¦¬ ì™„ë£Œ (' + approved.length + 'ê±´)</h4>';
            if (approved.length > 0) {
                html += '<div style="margin-top:10px;">';
                approved.slice(0, 5).forEach(s => {
                    html += `
                        <div class="alert-card success">
                            <strong>${s.empName}</strong> - ${s.item} (${s.qty}ê°œ) - ${s.date}
                        </div>
                    `;
                });
                html += '</div>';
            }
            
            supplyTable.innerHTML = html;
        }
        
        // ì†Œëª¨í’ˆ ìŠ¹ì¸
        function approveSupply(id) {
            const supply = supplies.find(s => s.id === id);
            if (supply) {
                supply.status = 'approved';
                saveData();
                alert('âœ… êµ¬ë§¤ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                updateSupplyList();
            }
        }
        
        // ìë™ ë°˜ë³µ ì—…ë¬´ ìƒì„±
        function generateRecurringTasks() {
            const today = new Date();
            const day = today.getDate();
            const month = today.getMonth() + 1;
            
            // ë§¤ì›” 10ì¼: ì›ì²œì„¸ ì‹ ê³ 
            if (day === 10) {
                const exists = kanbanTasks.some(t => t.title.includes(`${month}ì›” ì›ì²œì„¸ ì‹ ê³ `));
                if (!exists) {
                    kanbanTasks.push({
                        id: Date.now(),
                        title: `${month}ì›” ì›ì²œì„¸ ì‹ ê³  (ë§¤ì›” 10ì¼)`,
                        assignee: 'ê´€ë¦¬ì',
                        status: 'todo'
                    });
                }
            }
            
            // ë§¤ì›” 25ì¼: ê¸‰ì—¬ ì´ì²´
            if (day === 25) {
                const exists = kanbanTasks.some(t => t.title.includes(`${month}ì›” ê¸‰ì—¬ ì´ì²´`));
                if (!exists) {
                    kanbanTasks.push({
                        id: Date.now() + 1,
                        title: `${month}ì›” ê¸‰ì—¬ ì´ì²´ (ë§¤ì›” 25ì¼)`,
                        assignee: 'ê´€ë¦¬ì',
                        status: 'todo'
                    });
                }
            }
            
            // ë¶„ê¸°ë§: ë¶€ê°€ì„¸ ì‹ ê³ 
            if ([3, 6, 9, 12].includes(month) && day === 25) {
                const quarter = Math.ceil(month / 3);
                const exists = kanbanTasks.some(t => t.title.includes(`${quarter}ë¶„ê¸° ë¶€ê°€ì„¸`));
                if (!exists) {
                    kanbanTasks.push({
                        id: Date.now() + 2,
                        title: `${quarter}ë¶„ê¸° ë¶€ê°€ì„¸ ì‹ ê³ `,
                        assignee: 'ê´€ë¦¬ì',
                        status: 'todo'
                    });
                }
            }
            
            saveData();
            updateKanban();
        }

        // ========== ìë™ ë°±ì—… ê¸°ëŠ¥ ==========
        // 30ë¶„ë§ˆë‹¤ ìë™ ë°±ì—… (localStorageì— ë³„ë„ ì €ì¥)
        setInterval(function() {
            const autoBackup = {
                timestamp: new Date().toISOString(),
                data: {
                    employees: employees,
                    kanbanTasks: kanbanTasks,
                    meetingLogs: meetingLogs,
                    issueLogs: issueLogs,
                    itAssets: itAssets,
                    handovers: handovers,
                    supplies: supplies,
                    safetyChecks: safetyChecks,
                    grants: grants
                }
            };
            localStorage.setItem('hrAutoBackup', JSON.stringify(autoBackup));
        }, 30 * 60 * 1000); // 30ë¶„

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° í˜„í™© ì—…ë°ì´íŠ¸
        document.addEventListener('DOMContentLoaded', function() {
            // ê¸°ì¡´ ì´ˆê¸°í™”
            loadData();
            initializeSampleData();
            updateDashboard();
            updateAllSelects();
            updateEmployeeTable();
            updateDataCount();
            document.getElementById('todayDate').textContent = new Date().toLocaleDateString('ko-KR');
            
            // ë‚ ì§œ ì…ë ¥ í•„ë“œ ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì´ˆê¸°í™”
            const today = new Date().toISOString().split('T')[0];
            const dateInputs = ['attDocDate', 'certDate', 'payslipDate', 'legalFormDate'];
            dateInputs.forEach(id => {
                const elem = document.getElementById(id);
                if (elem) elem.value = today;
            });
        });
    </script>
</body>
</html>
